<!DOCTYPE html>
<html>
<head>
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta content="utf-8" http-equiv="encoding">
<base href="https://chromium.googlesource.com/">
<style type="text/css">
table.blueTable {
  border: 1px solid #1C6EA4;
  background-color: #EEEEEE;
  width: 100%;
  text-align: center;
  border-collapse: collapse;
}
table.blueTable td, table.blueTable th {
  border: 1px solid #AAAAAA;
  padding: 3px 2px;
}
table.blueTable tbody td {
  font-size: 16px;
}
table.blueTable tr:nth-child(even) {
  background: #D0E4F5;
}
table.blueTable thead {
  background: #3077A4;
  background: -moz-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: -webkit-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: linear-gradient(to bottom, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  border-bottom: 2px solid #444444;
}
table.blueTable thead th {
  font-size: 15px;
  font-weight: bold;
  color: #FFFFFF;
  text-align: center;
  border-left: 2px solid #D0E4F5;
}
table.blueTable thead th:first-child {
  border-left: none;
}
table.blueTable tfoot {
  font-size: 8px;
  font-weight: bold;
  color: #FFFFFF;
  background: #D0E4F5;
  background: -moz-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: -webkit-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: linear-gradient(to bottom, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  border-top: 2px solid #444444;
}
table.blueTable tfoot td {
  font-size: 8px;
}
table.blueTable tfoot .links {
  text-align: right;
}
table.blueTable tfoot .links a{
  display: inline-block;
  background: #1C6EA4;
  color: #FFFFFF;
  padding: 2px 8px;
  border-radius: 5px;
}
body{
    background: #fff2e0;
}
.Metadata {
    margin-bottom: 15px;
}
.u-monospace {
    font-family: 'Source Code Pro',monospace;
    max-width: 100%;
    overflow-x: scroll;
    border: groove #c33b3b 2px;
}
.MetadataMessage {
    background-color: #b9caff;
    border: 1px solid #de5353;
    color: #000;
    margin: 0;
    padding: 12px;
    white-space: pre-wrap;
}
</style>
</head>
<body>

    <table class="blueTable">
     <thead>
      <tr>
       <th><strong>REVISION ID</strong></th>
       <th>SHA-1 COMMIT</th>
      </tr>
    </thead>
    <tfoot></tfoot>
     <tbody>
      <tr>
       <td><a href ="https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Mac/1097561/"> 1097561</a> <sup><b>(MAC)</b></sup></td>
       <td><a href="https://chromium.googlesource.com/chromium/src/+/fa3d9b0c63e793ecb9addb3e37887ab00c2c0eaa">fa3d9b0c63e793ecb9addb3e37887ab00c2c0eaa</a></td>
      </tr>
      <tr>
       <td><a href ="https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Win/1097510/">1097510</a> <sup><b>(WIN)</b></sup></td>
       <td><a href="https://chromium.googlesource.com/chromium/src/+/e50c462e94aaa5c89d63153c9177f8d0960b46b4">e50c462e94aaa5c89d63153c9177f8d0960b46b4</a></td>
     </tbody>
    </table>
   <hr><table>
 <tr>
  <th class="Metadata-title">
   commit
  </th>
  <td>
   fa3d9b0c63e793ecb9addb3e37887ab00c2c0eaa
  </td>
  <td>
   <span>
    [
    <a href="/chromium/src/+log/fa3d9b0c63e793ecb9addb3e37887ab00c2c0eaa">
     log
    </a>
    ]
   </span>
   <span>
    [
    <a href="/chromium/src/+archive/fa3d9b0c63e793ecb9addb3e37887ab00c2c0eaa.tar.gz">
     tgz
    </a>
    ]
   </span>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   author
  </th>
  <td>
   Andres Calderon Jaramillo &lt;andrescj@chromium.org&gt;
  </td>
  <td>
   Thu Jan 26 20:12:29 2023
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   committer
  </th>
  <td>
   Chromium LUCI CQ &lt;chromium-scoped@luci-project-accounts.iam.gserviceaccount.com&gt;
  </td>
  <td>
   Thu Jan 26 20:12:29 2023
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   tree
  </th>
  <td>
   <a href="/chromium/src/+/fa3d9b0c63e793ecb9addb3e37887ab00c2c0eaa/">
    10680492931ebda8cdc104e4cd2c3bff2bb49082
   </a>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   parent
  </th>
  <td>
   <a href="/chromium/src/+/fa3d9b0c63e793ecb9addb3e37887ab00c2c0eaa%5E">
    26a02049228b923ce0511fe527b1bbaf2a2005f4
   </a>
   <span>
    [
    <a href="/chromium/src/+/fa3d9b0c63e793ecb9addb3e37887ab00c2c0eaa%5E%21/">
     diff
    </a>
    ]
   </span>
  </td>
 </tr>
</table><hr style="height:1px;border-width:0;color:gray;background-color:gray"><pre class="u-pre u-monospace MetadataMessage">viz: Don't fill the supported video decoder profiles in GpuServiceImpl.

This CL removes the code that fills the
|video_decode_accelerator_supported_profiles| member of the gpu::GPUInfo
struct during a call to GpuServiceImpl::UpdateGPUInfo() (which should
run while the GPU process is starting up). The reason is that this
startup query represents a bit of an obstacle for out-of-process video
decoding: when this feature is enabled (eventually on Linux/ChromeOS),
the query for supported video decoder profiles will be done in a utility
process instead of the GPU process. When the GPU process is starting up,
we don't have a connection to that utility process. It's better if the
supported video decoder profiles are queried as needed.

At the time of writing this CL, code search revealed the following
usages of the |video_decode_accelerator_supported_profiles| member:

- The SystemInfo domain from the DevTools protocol [1]: the getInfo()
  API exposes the supported video decode accelerator profiles. However,
  this API was introduced for testing which doesn't actually need the
  supported video decoder profiles. Therefore, it's fine that after this
  CL, this info won't be available (unless chrome://gpu is opened before
  the SystemInfo.getInfo() method runs - in this case, the supported
  video decode accelerator profiles will become available for
  SystemInfo.getInfo() to access).

- The chrome://gpu UI: this path already doesn't rely on the GPU process
  startup query [2], and since it uses GpuDataManagerImpl, it already
  knows how to deal with out-of-process video decoding.

Note: before this CL, there was a comment in GpuServiceImpl suggesting
that the startup query was needed for PPAPI/Flash [3]. However, code
search did not reveal any current dependency of Pepper on the
|video_decode_accelerator_supported_profiles| member, so that comment is
obsolete.

[1] <a href="https://chromedevtools.github.io/devtools-protocol/tot/SystemInfo/">https://chromedevtools.github.io/devtools-protocol/tot/SystemInfo/</a>
[2] <a href="https://source.chromium.org/chromium/chromium/src/+/main:content/browser/gpu/gpu_internals_ui.cc;l=797-802;drc=85a8bf56bee1ca1bb95c781b30128beb8c73b35a">https://source.chromium.org/chromium/chromium/src/+/main:content/browser/gpu/gpu_internals_ui.cc;l=797-802;drc=85a8bf56bee1ca1bb95c781b30128beb8c73b35a</a>
[3] <a href="https://source.chromium.org/chromium/chromium/src/+/main:components/viz/service/gl/gpu_service_impl.cc;l=288-289;drc=12be03159fe22cd4ef291e9561762531c2589539">https://source.chromium.org/chromium/chromium/src/+/main:components/viz/service/gl/gpu_service_impl.cc;l=288-289;drc=12be03159fe22cd4ef291e9561762531c2589539</a>

Bug: b:195769334
Test: ran SystemInfo.getInfo() on a ChromeOS device
Test: ensured that chrome://gpu shows the supported video decoder profiles on a ChromeOS device
Test: video.PepperVideoDecode.h264_hw on volteer (ChromeOS device)
Test: video.PepperVideoDecode.h264_hw_mojovd on volteer (ChromeOS device)
Test: video.PlayDRM.cencv3_h264_cbc on volteer (ChromeOS device)
Change-Id: <a href="https://chromium-review.googlesource.com/#/q/I40e745cd4dc2de4aebbaee9a2f3e77863352589b">I40e745cd4dc2de4aebbaee9a2f3e77863352589b</a>
Reviewed-on: <a href="https://chromium-review.googlesource.com/c/chromium/src/+/4193451">https://chromium-review.googlesource.com/c/chromium/src/+/4193451</a>
Reviewed-by: Dale Curtis &lt;dalecurtis@chromium.org&gt;
Reviewed-by: Kenneth Russell &lt;kbr@chromium.org&gt;
Commit-Queue: Andres Calderon Jaramillo &lt;andrescj@chromium.org&gt;
Cr-Commit-Position: refs/heads/main@{#1097561}
</pre>

</body>
</html>
