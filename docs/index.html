<!DOCTYPE html>
<html>
<head>
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta content="utf-8" http-equiv="encoding">
<base href="https://chromium.googlesource.com/">
<style type="text/css">
table.blueTable {
  border: 1px solid #1C6EA4;
  background-color: #EEEEEE;
  width: 100%;
  text-align: center;
  border-collapse: collapse;
}
table.blueTable td, table.blueTable th {
  border: 1px solid #AAAAAA;
  padding: 3px 2px;
}
table.blueTable tbody td {
  font-size: 16px;
}
table.blueTable tr:nth-child(even) {
  background: #D0E4F5;
}
table.blueTable thead {
  background: #3077A4;
  background: -moz-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: -webkit-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: linear-gradient(to bottom, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  border-bottom: 2px solid #444444;
}
table.blueTable thead th {
  font-size: 15px;
  font-weight: bold;
  color: #FFFFFF;
  text-align: center;
  border-left: 2px solid #D0E4F5;
}
table.blueTable thead th:first-child {
  border-left: none;
}
table.blueTable tfoot {
  font-size: 8px;
  font-weight: bold;
  color: #FFFFFF;
  background: #D0E4F5;
  background: -moz-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: -webkit-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: linear-gradient(to bottom, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  border-top: 2px solid #444444;
}
table.blueTable tfoot td {
  font-size: 8px;
}
table.blueTable tfoot .links {
  text-align: right;
}
table.blueTable tfoot .links a{
  display: inline-block;
  background: #1C6EA4;
  color: #FFFFFF;
  padding: 2px 8px;
  border-radius: 5px;
}
body{
    background: #fff2e0;
}
.Metadata {
    margin-bottom: 15px;
}
.u-monospace {
    font-family: 'Source Code Pro',monospace;
    max-width: 100%;
    overflow-x: scroll;
    border: groove #c33b3b 2px;
}
.MetadataMessage {
    background-color: #b9caff;
    border: 1px solid #de5353;
    color: #000;
    margin: 0;
    padding: 12px;
    white-space: pre-wrap;
}
</style>
</head>
<body>

    <table class="blueTable">
     <thead>
      <tr>
       <th><strong>REVISION ID</strong></th>
       <th>SHA-1 COMMIT</th>
      </tr>
    </thead>
    <tfoot></tfoot>
     <tbody>
      <tr>
       <td><a href ="https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Mac/981511/"> 981511</a> <sup><b>(MAC)</b></sup></td>
       <td><a href="https://chromium.googlesource.com/chromium/src/+/b77aedcb5121bff60a6f0d65070d060815076936">b77aedcb5121bff60a6f0d65070d060815076936</a></td>
      </tr>
      <tr>
       <td><a href ="https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Win/981511/">981511</a> <sup><b>(WIN)</b></sup></td>
       <td><a href="https://chromium.googlesource.com/chromium/src/+/b77aedcb5121bff60a6f0d65070d060815076936">b77aedcb5121bff60a6f0d65070d060815076936</a></td>
     </tbody>
    </table>
   <hr><table>
 <tr>
  <th class="Metadata-title">
   commit
  </th>
  <td>
   b77aedcb5121bff60a6f0d65070d060815076936
  </td>
  <td>
   <span>
    [
    <a href="/chromium/src/+log/b77aedcb5121bff60a6f0d65070d060815076936">
     log
    </a>
    ]
   </span>
   <span>
    [
    <a href="/chromium/src/+archive/b77aedcb5121bff60a6f0d65070d060815076936.tar.gz">
     tgz
    </a>
    ]
   </span>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   author
  </th>
  <td>
   Delan Azabani &lt;dazabani@igalia.com&gt;
  </td>
  <td>
   Wed Mar 16 06:43:20 2022
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   committer
  </th>
  <td>
   Chromium LUCI CQ &lt;chromium-scoped@luci-project-accounts.iam.gserviceaccount.com&gt;
  </td>
  <td>
   Wed Mar 16 06:43:20 2022
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   tree
  </th>
  <td>
   <a href="/chromium/src/+/b77aedcb5121bff60a6f0d65070d060815076936/">
    6565776b53b6cd21f281daa9899de760dedbc7d8
   </a>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   parent
  </th>
  <td>
   <a href="/chromium/src/+/b77aedcb5121bff60a6f0d65070d060815076936%5E">
    b90242620f14857bc18b9cdcffd6a64d107bf730
   </a>
   <span>
    [
    <a href="/chromium/src/+/b77aedcb5121bff60a6f0d65070d060815076936%5E%21/">
     diff
    </a>
    ]
   </span>
  </td>
 </tr>
</table><hr style="height:1px;border-width:0;color:gray;background-color:gray"><pre class="u-pre u-monospace MetadataMessage">CSS highlight painting: implement initial highlight overlay system

Highlights have historically fallen into one of two categories:
::selection, which was exposed to CSS and painted with great care, and
markers, which were *not* exposed to CSS and painted rather naïvely.

With ::target-text, ::{spelling,grammar}-error, and ::highlight, we
need to generalise some of ::selection’s paint logic to ensure, among
other things, that we never paint any piece of text proper (non-shadow
text) more than once.

This patch adds a HighlightOverlayPainting feature flag. When enabled,
we stop painting those pseudos in NGHighlightPainter::Paint except for
::selection drag image, and paint them in the new PaintOriginatingText
+ PaintHighlighOverlays methods, which are analogous to ::selection’s
PaintSuppressingTextProperWhereSelected + PaintSelectedText methods.

These methods rely on new algorithms that preprocess the highlighted
ranges into “layers”, “edges”, and “parts”, to determine which ranges
we need to paint now and which ones need to be suppressed (lifted to
a “higher” layer).

Note that this impl is not complete! It lacks support for decorations
and most of the subtle logic in the ::selection painting code and the
old ComputeMarkersToPaint.

Example test page and screenshot below. Notice how the backgrounds now
obscure the originating shadow, the antialiasing artifacts are gone,
and the highlighted text proper is no longer darkened by text in the
originating style (black).

• <a href="https://bucket.daz.cat/work/igalia/0/32.html">https://bucket.daz.cat/work/igalia/0/32.html</a>
• <a href="https://bucket.daz.cat/164c466b6b4bded7.png">https://bucket.daz.cat/164c466b6b4bded7.png</a> (top is HighlightAPI and
  CSSSpellingGrammarErrors only, bottom adds HighlightOverlayPainting)

Bug: 1147859, 1179938
Change-Id: <a href="https://chromium-review.googlesource.com/#/q/Icab783a2499fa824c105acd6dde739852963696c">Icab783a2499fa824c105acd6dde739852963696c</a>
Cq-Do-Not-Cancel-Tryjobs: true
Reviewed-on: <a href="https://chromium-review.googlesource.com/c/chromium/src/+/3426940">https://chromium-review.googlesource.com/c/chromium/src/+/3426940</a>
Reviewed-by: Yoshifumi Inoue &lt;yosin@chromium.org&gt;
Reviewed-by: Koji Ishii &lt;kojii@chromium.org&gt;
Commit-Queue: Delan Azabani &lt;dazabani@igalia.com&gt;
Cr-Commit-Position: refs/heads/main@{#981511}
</pre>

</body>
</html>
