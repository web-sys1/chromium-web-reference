<!DOCTYPE html>
<html>
<head>
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta content="utf-8" http-equiv="encoding">
<base href="https://chromium.googlesource.com/">
<style type="text/css">
table.blueTable {
  border: 1px solid #1C6EA4;
  background-color: #EEEEEE;
  width: 100%;
  text-align: center;
  border-collapse: collapse;
}
table.blueTable td, table.blueTable th {
  border: 1px solid #AAAAAA;
  padding: 3px 2px;
}
table.blueTable tbody td {
  font-size: 16px;
}
table.blueTable tr:nth-child(even) {
  background: #D0E4F5;
}
table.blueTable thead {
  background: #3077A4;
  background: -moz-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: -webkit-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: linear-gradient(to bottom, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  border-bottom: 2px solid #444444;
}
table.blueTable thead th {
  font-size: 15px;
  font-weight: bold;
  color: #FFFFFF;
  text-align: center;
  border-left: 2px solid #D0E4F5;
}
table.blueTable thead th:first-child {
  border-left: none;
}
table.blueTable tfoot {
  font-size: 8px;
  font-weight: bold;
  color: #FFFFFF;
  background: #D0E4F5;
  background: -moz-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: -webkit-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: linear-gradient(to bottom, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  border-top: 2px solid #444444;
}
table.blueTable tfoot td {
  font-size: 8px;
}
table.blueTable tfoot .links {
  text-align: right;
}
table.blueTable tfoot .links a{
  display: inline-block;
  background: #1C6EA4;
  color: #FFFFFF;
  padding: 2px 8px;
  border-radius: 5px;
}
body{
    background: #fff2e0;
}
.Metadata {
    margin-bottom: 15px;
}
.u-monospace {
    font-family: 'Source Code Pro',monospace;
    max-width: 100%;
    overflow-x: scroll;
    border: groove #c33b3b 2px;
}
.MetadataMessage {
    background-color: #b9caff;
    border: 1px solid #de5353;
    color: #000;
    margin: 0;
    padding: 12px;
    white-space: pre-wrap;
}
</style>
</head>
<body>

    <table class="blueTable">
     <thead>
      <tr>
       <th><strong>REVISION ID</strong></th>
       <th>SHA-1 COMMIT</th>
      </tr>
    </thead>
    <tfoot></tfoot>
     <tbody>
      <tr>
       <td><a href ="https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Mac/1000674/"> 1000674</a> <sup><b>(MAC)</b></sup></td>
       <td><a href="https://chromium.googlesource.com/chromium/src/+/2e74c191c76aca3a64ee3fe56c736a1dfa5b6c05">2e74c191c76aca3a64ee3fe56c736a1dfa5b6c05</a></td>
      </tr>
      <tr>
       <td><a href ="https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Win/1000658/">1000658</a> <sup><b>(WIN)</b></sup></td>
       <td><a href="https://chromium.googlesource.com/chromium/src/+/3e24e465fe52b37ebc0228cd18dd84cdd991e429">3e24e465fe52b37ebc0228cd18dd84cdd991e429</a></td>
     </tbody>
    </table>
   <hr><table>
 <tr>
  <th class="Metadata-title">
   commit
  </th>
  <td>
   2e74c191c76aca3a64ee3fe56c736a1dfa5b6c05
  </td>
  <td>
   <span>
    [
    <a href="/chromium/src/+log/2e74c191c76aca3a64ee3fe56c736a1dfa5b6c05">
     log
    </a>
    ]
   </span>
   <span>
    [
    <a href="/chromium/src/+archive/2e74c191c76aca3a64ee3fe56c736a1dfa5b6c05.tar.gz">
     tgz
    </a>
    ]
   </span>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   author
  </th>
  <td>
   Alex Moshchuk &lt;alexmos@chromium.org&gt;
  </td>
  <td>
   Sat May 07 03:16:42 2022
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   committer
  </th>
  <td>
   Chromium LUCI CQ &lt;chromium-scoped@luci-project-accounts.iam.gserviceaccount.com&gt;
  </td>
  <td>
   Sat May 07 03:16:42 2022
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   tree
  </th>
  <td>
   <a href="/chromium/src/+/2e74c191c76aca3a64ee3fe56c736a1dfa5b6c05/">
    6d1e6813c7aa58d32c455a63c8a2957c32f22395
   </a>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   parent
  </th>
  <td>
   <a href="/chromium/src/+/2e74c191c76aca3a64ee3fe56c736a1dfa5b6c05%5E">
    48c3a804c89ac1723e94b101824c599156617a43
   </a>
   <span>
    [
    <a href="/chromium/src/+/2e74c191c76aca3a64ee3fe56c736a1dfa5b6c05%5E%21/">
     diff
    </a>
    ]
   </span>
  </td>
 </tr>
</table><hr style="height:1px;border-width:0;color:gray;background-color:gray"><pre class="u-pre u-monospace MetadataMessage">&lt;webview&gt; site isolation: enable subframe process reuse

This CL allows subframe process reuse policy to work inside
site-isolated guests.  This requires three changes:

1. Removing the restriction on the pending and committed &lt;SiteInfo,
process&gt; maps to only track entries for default StoragePartitions.
Previously, this was necessary because the maps were indexed by site
URLs, which didn't convey StoragePartition information.  Now, they are
keyed by SiteInfo, which includes StoragePartitionConfigs.

2. Removing the artificial restriction in
RenderProcessHostImpl::IsSuitableHost() to disallow any process reuse
for guests.  The intent was to not accidentally mix StoragePartitions,
as well as disallow mixing guest and non-guest storage.  The check is
modified to disallow just the latter case: reusing a guest process for
a non-guest SiteInfo and vice versa. Another existing check a few
lines below already ensures that a process can only be reused for a
SiteInfo in the same StoragePartition, so this should be safe.

3. NavigationRequest::GetUrlInfo() is updated to explicitly specify a
StoragePartitionConfig for navigations in guests.  Previously, this
wasn't needed because guest navigations would ensure this via a
different path (e.g., BrowsingInstance::ComputeSiteInfoForURL()
ensures that all navigations where UrlInfo doesn't specify a
StoragePartition still stay in the same StoragePartition).  However,
process reuse needs to directly compute SiteInfo from UrlInfo in
places like RenderFrameHostImpl::SetLastCommittedSiteInfo(), so it
seems better/safer to simply set the StoragePartitionConfig in
NavigationRequest::GetUrlInfo() that pertains to guest navigations
(retrieving the StoragePartitionConfig from the current/starting
SiteInstance).  Note that the first guest SiteInstance's
StoragePartitionConfig is set via SiteInstance::CreateForGuest() when
the embedder first creates a &lt;webview&gt;.

Bug: 1267977, 1322183, 752667
Change-Id: <a href="https://chromium-review.googlesource.com/#/q/I652c6dacfd13d387d197adba448c6c0b74d81b6a">I652c6dacfd13d387d197adba448c6c0b74d81b6a</a>
Reviewed-on: <a href="https://chromium-review.googlesource.com/c/chromium/src/+/3631517">https://chromium-review.googlesource.com/c/chromium/src/+/3631517</a>
Commit-Queue: Alex Moshchuk &lt;alexmos@chromium.org&gt;
Reviewed-by: James Maclean &lt;wjmaclean@chromium.org&gt;
Reviewed-by: Charlie Reis &lt;creis@chromium.org&gt;
Cr-Commit-Position: refs/heads/main@{#1000674}
</pre>

</body>
</html>
