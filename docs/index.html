
<!DOCTYPE html>
<html>
<head>
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta content="utf-8" http-equiv="encoding">
<base href="https://chromium.googlesource.com/">
<style type="text/css">
table.blueTable {
  border: 1px solid #1C6EA4;
  background-color: #EEEEEE;
  width: 100%;
  text-align: center;
  border-collapse: collapse;
}
table.blueTable td, table.blueTable th {
  border: 1px solid #AAAAAA;
  padding: 3px 2px;
}
table.blueTable tbody td {
  font-size: 16px;
}
table.blueTable tr:nth-child(even) {
  background: #D0E4F5;
}
table.blueTable thead {
  background: #3077A4;
  background: -moz-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: -webkit-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: linear-gradient(to bottom, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  border-bottom: 2px solid #444444;
}
table.blueTable thead th {
  font-size: 15px;
  font-weight: bold;
  color: #FFFFFF;
  text-align: center;
  border-left: 2px solid #D0E4F5;
}
table.blueTable thead th:first-child {
  border-left: none;
}

table.blueTable tfoot {
  font-size: 8px;
  font-weight: bold;
  color: #FFFFFF;
  background: #D0E4F5;
  background: -moz-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: -webkit-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: linear-gradient(to bottom, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  border-top: 2px solid #444444;
}
table.blueTable tfoot td {
  font-size: 8px;
}
table.blueTable tfoot .links {
  text-align: right;
}
table.blueTable tfoot .links a{
  display: inline-block;
  background: #1C6EA4;
  color: #FFFFFF;
  padding: 2px 8px;
  border-radius: 5px;
}

body{
    background: #fff2e0;
}
.Metadata {
    margin-bottom: 15px;
}
.u-monospace {
    font-family: 'Source Code Pro',monospace;
    max-width: 100%;
    overflow-x: scroll;
    border: groove #c33b3b 2px;
}
.MetadataMessage {
    background-color: #b9caff;
    border: 1px solid #de5353;
    color: #000;
    margin: 0;
    padding: 12px;
    white-space: pre-wrap;
}
</style>
</head>
<body>

    <table class="blueTable">
     <thead>
      <tr>
       <th><strong>REVISION ID</strong></th>
       <th>SHA-1 COMMIT</th>
      </tr>
    </thead>
    <tfoot></tfoot>
     <tbody>
      <tr>
       <td>817596</td>
       <td>29c3019a63b973f7e8a47931067895749731a110</td>
      </tr>
     </tbody>
    </table>
   <hr><table>
 <tr>
  <th class="Metadata-title">
   commit
  </th>
  <td>
   29c3019a63b973f7e8a47931067895749731a110
  </td>
  <td>
   <span>
    [
    <a href="/chromium/src/+log/29c3019a63b973f7e8a47931067895749731a110">
     log
    </a>
    ]
   </span>
   <span>
    [
    <a href="/chromium/src/+archive/29c3019a63b973f7e8a47931067895749731a110.tar.gz">
     tgz
    </a>
    ]
   </span>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   author
  </th>
  <td>
   Victor Hugo Vianna Silva &lt;victorvianna@google.com&gt;
  </td>
  <td>
   Thu Oct 15 18:54:04 2020
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   committer
  </th>
  <td>
   Commit Bot &lt;commit-bot@chromium.org&gt;
  </td>
  <td>
   Thu Oct 15 18:54:04 2020
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   tree
  </th>
  <td>
   <a href="/chromium/src/+/29c3019a63b973f7e8a47931067895749731a110/">
    64b2ff1e5dd3ea3e284e813a522f876ddd3b7677
   </a>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   parent
  </th>
  <td>
   <a href="/chromium/src/+/29c3019a63b973f7e8a47931067895749731a110%5E">
    862a1a2c9a2b29405ef1867ae2de0fad331ac430
   </a>
   <span>
    [
    <a href="/chromium/src/+/29c3019a63b973f7e8a47931067895749731a110%5E%21/">
     diff
    </a>
    ]
   </span>
  </td>
 </tr>
</table><hr style="height:1px;border-width:0;color:gray;background-color:gray"><pre class="u-pre u-monospace MetadataMessage">[Sync] Fix race condition for Directory files deletion

ProfileSyncService has logic to delete the legacy Directory files on
shutdown if the sync engine doesn't exist (normally the engine would do
the deletion). One consequence of crrev.com/c/2461325 is that the engine
implementation and this deletion no longer have ordering guarantees. If
sync is immediately restarted, it's possible that a new engine will be
created before the deletion finishes, which is a race condition.

This CL fixes the issue by exposing a deletion method in
SyncApiComponentFactory (the class responsible by creating engines)
which is guaranteed to run sequentially with the implementation of any
engine it creates. As a bonus, this removes some assumptions made by
ProfileSyncService that the underlying SyncEngine is actually a
SyncEngineImpl.

Fixed: 1123881
Change-Id: <a href="https://chromium-review.googlesource.com/#/q/I55528019863eeca9f90c09172c410a87f74e0bd1">I55528019863eeca9f90c09172c410a87f74e0bd1</a>
Reviewed-on: <a href="https://chromium-review.googlesource.com/c/chromium/src/+/2476434">https://chromium-review.googlesource.com/c/chromium/src/+/2476434</a>
Commit-Queue: Victor Vianna &lt;victorvianna@google.com&gt;
Reviewed-by: Marc Treib &lt;treib@chromium.org&gt;
Cr-Commit-Position: refs/heads/master@{#817596}
</pre>

</body>
</html>
