<!DOCTYPE html>
<html>
<head>
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta content="utf-8" http-equiv="encoding">
<base href="https://chromium.googlesource.com/">
<style type="text/css">
table.blueTable {
  border: 1px solid #1C6EA4;
  background-color: #EEEEEE;
  width: 100%;
  text-align: center;
  border-collapse: collapse;
}
table.blueTable td, table.blueTable th {
  border: 1px solid #AAAAAA;
  padding: 3px 2px;
}
table.blueTable tbody td {
  font-size: 16px;
}
table.blueTable tr:nth-child(even) {
  background: #D0E4F5;
}
table.blueTable thead {
  background: #3077A4;
  background: -moz-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: -webkit-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: linear-gradient(to bottom, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  border-bottom: 2px solid #444444;
}
table.blueTable thead th {
  font-size: 15px;
  font-weight: bold;
  color: #FFFFFF;
  text-align: center;
  border-left: 2px solid #D0E4F5;
}
table.blueTable thead th:first-child {
  border-left: none;
}
table.blueTable tfoot {
  font-size: 8px;
  font-weight: bold;
  color: #FFFFFF;
  background: #D0E4F5;
  background: -moz-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: -webkit-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: linear-gradient(to bottom, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  border-top: 2px solid #444444;
}
table.blueTable tfoot td {
  font-size: 8px;
}
table.blueTable tfoot .links {
  text-align: right;
}
table.blueTable tfoot .links a{
  display: inline-block;
  background: #1C6EA4;
  color: #FFFFFF;
  padding: 2px 8px;
  border-radius: 5px;
}
body{
    background: #fff2e0;
}
.Metadata {
    margin-bottom: 15px;
}
.u-monospace {
    font-family: 'Source Code Pro',monospace;
    max-width: 100%;
    overflow-x: scroll;
    border: groove #c33b3b 2px;
}
.MetadataMessage {
    background-color: #b9caff;
    border: 1px solid #de5353;
    color: #000;
    margin: 0;
    padding: 12px;
    white-space: pre-wrap;
}
</style>
</head>
<body>

    <table class="blueTable">
     <thead>
      <tr>
       <th><strong>REVISION ID</strong></th>
       <th>SHA-1 COMMIT</th>
      </tr>
    </thead>
    <tfoot></tfoot>
     <tbody>
      <tr>
       <td><a href ="https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Mac/987815/"> 987815</a> <sup><b>(MAC)</b></sup></td>
       <td><a href="https://chromium.googlesource.com/chromium/src/+/8d5fc9388db29d91c2858d950fa013692283545c">8d5fc9388db29d91c2858d950fa013692283545c</a></td>
      </tr>
      <tr>
       <td><a href ="https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Win/987786/">987786</a> <sup><b>(WIN)</b></sup></td>
       <td><a href="https://chromium.googlesource.com/chromium/src/+/e1793206f4d5fa744aeb1ef7623bf54c7d3fb7c4">e1793206f4d5fa744aeb1ef7623bf54c7d3fb7c4</a></td>
     </tbody>
    </table>
   <hr><table>
 <tr>
  <th class="Metadata-title">
   commit
  </th>
  <td>
   8d5fc9388db29d91c2858d950fa013692283545c
  </td>
  <td>
   <span>
    [
    <a href="/chromium/src/+log/8d5fc9388db29d91c2858d950fa013692283545c">
     log
    </a>
    ]
   </span>
   <span>
    [
    <a href="/chromium/src/+archive/8d5fc9388db29d91c2858d950fa013692283545c.tar.gz">
     tgz
    </a>
    ]
   </span>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   author
  </th>
  <td>
   Timothy Loh &lt;timloh@chromium.org&gt;
  </td>
  <td>
   Fri Apr 01 07:24:15 2022
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   committer
  </th>
  <td>
   Chromium LUCI CQ &lt;chromium-scoped@luci-project-accounts.iam.gserviceaccount.com&gt;
  </td>
  <td>
   Fri Apr 01 07:24:15 2022
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   tree
  </th>
  <td>
   <a href="/chromium/src/+/8d5fc9388db29d91c2858d950fa013692283545c/">
    09d6fb1ad71bcd8e6716ff022bc91f8daed32329
   </a>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   parent
  </th>
  <td>
   <a href="/chromium/src/+/8d5fc9388db29d91c2858d950fa013692283545c%5E">
    eb0ac174079fb6cc14406d14cd21f2612fe6a36b
   </a>
   <span>
    [
    <a href="/chromium/src/+/8d5fc9388db29d91c2858d950fa013692283545c%5E%21/">
     diff
    </a>
    ]
   </span>
  </td>
 </tr>
</table><hr style="height:1px;border-width:0;color:gray;background-color:gray"><pre class="u-pre u-monospace MetadataMessage">Tidy up CrostiniRestarter abort flow and options for stopping early

We currently have start_vm_only and stop_after_lxd_available. The latter
is somewhat buggy as it uses FinishRestart which means that any other
pending restarters for that container wouldn't actually get run. The
former uses Abort, which works correctly but the flow for it is
pretty messy.

- The Abort flow now has less callback indirection. The callback given
to AbortRestartCrostini is passed directly to the restarter instead of
being wrapped. Move the logic in OnAbortRestartCrostini which starts
the next restarter FinishRestart to make this work.
- Use FinishRestart for start_vm_only instead of Abort. Also
move this to after we check if starting the VM actually succeeded.
- Add a test for stop_after_lxd_available and another simultaneous
restarter as it should work now.
- The RestarterTimeInState2 metric for aborted restarts is also fixed to
correctly log the last state.

Bug: b/227693911

Change-Id: <a href="https://chromium-review.googlesource.com/#/q/I93735f87e1474562e7c77abc43c41d8078f11216">I93735f87e1474562e7c77abc43c41d8078f11216</a>
Reviewed-on: <a href="https://chromium-review.googlesource.com/c/chromium/src/+/3562799">https://chromium-review.googlesource.com/c/chromium/src/+/3562799</a>
Reviewed-by: Joel Hockey &lt;joelhockey@chromium.org&gt;
Commit-Queue: Timothy Loh &lt;timloh@chromium.org&gt;
Cr-Commit-Position: refs/heads/main@{#987815}
</pre>

</body>
</html>
