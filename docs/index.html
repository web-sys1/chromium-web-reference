<!DOCTYPE html>
<html>
<head>
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta content="utf-8" http-equiv="encoding">
<base href="https://chromium.googlesource.com/">
<style type="text/css">
table.blueTable {
  border: 1px solid #1C6EA4;
  background-color: #EEEEEE;
  width: 100%;
  text-align: center;
  border-collapse: collapse;
}
table.blueTable td, table.blueTable th {
  border: 1px solid #AAAAAA;
  padding: 3px 2px;
}
table.blueTable tbody td {
  font-size: 16px;
}
table.blueTable tr:nth-child(even) {
  background: #D0E4F5;
}
table.blueTable thead {
  background: #3077A4;
  background: -moz-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: -webkit-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: linear-gradient(to bottom, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  border-bottom: 2px solid #444444;
}
table.blueTable thead th {
  font-size: 15px;
  font-weight: bold;
  color: #FFFFFF;
  text-align: center;
  border-left: 2px solid #D0E4F5;
}
table.blueTable thead th:first-child {
  border-left: none;
}
table.blueTable tfoot {
  font-size: 8px;
  font-weight: bold;
  color: #FFFFFF;
  background: #D0E4F5;
  background: -moz-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: -webkit-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: linear-gradient(to bottom, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  border-top: 2px solid #444444;
}
table.blueTable tfoot td {
  font-size: 8px;
}
table.blueTable tfoot .links {
  text-align: right;
}
table.blueTable tfoot .links a{
  display: inline-block;
  background: #1C6EA4;
  color: #FFFFFF;
  padding: 2px 8px;
  border-radius: 5px;
}
body{
    background: #fff2e0;
}
.Metadata {
    margin-bottom: 15px;
}
.u-monospace {
    font-family: 'Source Code Pro',monospace;
    max-width: 100%;
    overflow-x: scroll;
    border: groove #c33b3b 2px;
}
.MetadataMessage {
    background-color: #b9caff;
    border: 1px solid #de5353;
    color: #000;
    margin: 0;
    padding: 12px;
    white-space: pre-wrap;
}
</style>
</head>
<body>

    <table class="blueTable">
     <thead>
      <tr>
       <th><strong>REVISION ID</strong></th>
       <th>SHA-1 COMMIT</th>
      </tr>
    </thead>
    <tfoot></tfoot>
     <tbody>
      <tr>
       <td><a href ="https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Mac/1039661/"> 1039661</a> <sup><b>(MAC)</b></sup></td>
       <td><a href="https://chromium.googlesource.com/chromium/src/+/f6cd769a880007d524037a2d95736081a34ce704">f6cd769a880007d524037a2d95736081a34ce704</a></td>
      </tr>
      <tr>
       <td><a href ="https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Win/1039650/">1039650</a> <sup><b>(WIN)</b></sup></td>
       <td><a href="https://chromium.googlesource.com/chromium/src/+/4017c8e8eea52f9f7196b08e94f966e75c266666">4017c8e8eea52f9f7196b08e94f966e75c266666</a></td>
     </tbody>
    </table>
   <hr><table>
 <tr>
  <th class="Metadata-title">
   commit
  </th>
  <td>
   f6cd769a880007d524037a2d95736081a34ce704
  </td>
  <td>
   <span>
    [
    <a href="/chromium/src/+log/f6cd769a880007d524037a2d95736081a34ce704">
     log
    </a>
    ]
   </span>
   <span>
    [
    <a href="/chromium/src/+archive/f6cd769a880007d524037a2d95736081a34ce704.tar.gz">
     tgz
    </a>
    ]
   </span>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   author
  </th>
  <td>
   Jonathan Hao &lt;phao@chromium.org&gt;
  </td>
  <td>
   Fri Aug 26 09:18:21 2022
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   committer
  </th>
  <td>
   Chromium LUCI CQ &lt;chromium-scoped@luci-project-accounts.iam.gserviceaccount.com&gt;
  </td>
  <td>
   Fri Aug 26 09:18:21 2022
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   tree
  </th>
  <td>
   <a href="/chromium/src/+/f6cd769a880007d524037a2d95736081a34ce704/">
    fef9480e7c9a1f4dbba2463570b1be90669ce865
   </a>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   parent
  </th>
  <td>
   <a href="/chromium/src/+/f6cd769a880007d524037a2d95736081a34ce704%5E">
    7557c08f29c31d40cad9f45d87f8d5f4be58488f
   </a>
   <span>
    [
    <a href="/chromium/src/+/f6cd769a880007d524037a2d95736081a34ce704%5E%21/">
     diff
    </a>
    ]
   </span>
  </td>
 </tr>
</table><hr style="height:1px;border-width:0;color:gray;background-color:gray"><pre class="u-pre u-monospace MetadataMessage">Policy container inheritance for service workers

Project: <a href="https://docs.google.com/document/d/1mAuxWRLcmhghtCoapc30nLo0H12XTMZUJWqw079XOR8/edit?hl=en&amp;forcehl=1">https://docs.google.com/document/d/1mAuxWRLcmhghtCoapc30nLo0H12XTMZUJWqw079XOR8/edit?hl=en&amp;forcehl=1</a>

This is the part about service worker.

Attach a PolicyContainerHost to ServiceWorkerVersion. This
PolicyContainerHost is obtained:
- for local schemes by cloning the creatorâ€™s PolicyContainerHost in
  ServiceWorkerRegisterJob::StartWorkerForUpdate
- for network schemes by parsing the policies from the response headers
  inside ServiceWorkerNewScriptLoader::OnReceiveResponse (new script) or
  ServiceWorkerSingleScriptUpdateChecker::OnReceiveResponse (updated
  script).
- for previously loaded script which is stored in the database, we write
  the policy container policies to db just like the existing service
  worker data, hence the changes around service worker database and
  protocol buffer. - The sandbox flags is represented as a int32 instead
  of a enum because protocol buffer enums can't be or'ed like a flag.
- CSP is skipped in this CL because the type is quite complicated and
  require a lot more work.  We don't seem to use the policy container CSP
  in the renderer anyway.
- I added a test to make sure that the encoding and decoding works

The policy container is then passed down to renderer and set as the
execution context's policy container.

This CL also fixes
external/wpt/html/cross-origin-embedder-policy/reflection-credentialless.tentative.https.any.serviceworker.html
and
external/wpt/html/cross-origin-embedder-policy/reflection-require-corp.tentative.https.any.serviceworker.html
because the passed down policy container contains the correct COEP.

Follow-ups: merge CSPs into our policy container.

Bug: 1177199
Change-Id: <a href="https://chromium-review.googlesource.com/#/q/Ie90c02b8dd3e295c5456e7e2ff03685339277d6a">Ie90c02b8dd3e295c5456e7e2ff03685339277d6a</a>
Reviewed-on: <a href="https://chromium-review.googlesource.com/c/chromium/src/+/3766681">https://chromium-review.googlesource.com/c/chromium/src/+/3766681</a>
Commit-Queue: Jonathan Hao &lt;phao@chromium.org&gt;
Reviewed-by: Arthur Sonzogni &lt;arthursonzogni@chromium.org&gt;
Reviewed-by: Dominick Ng &lt;dominickn@chromium.org&gt;
Reviewed-by: Hiroki Nakagawa &lt;nhiroki@chromium.org&gt;
Cr-Commit-Position: refs/heads/main@{#1039661}
</pre>

</body>
</html>
