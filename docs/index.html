<!DOCTYPE html>
<html>
<head>
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta content="utf-8" http-equiv="encoding">
<base href="https://chromium.googlesource.com/">
<style type="text/css">
table.blueTable {
  border: 1px solid #1C6EA4;
  background-color: #EEEEEE;
  width: 100%;
  text-align: center;
  border-collapse: collapse;
}
table.blueTable td, table.blueTable th {
  border: 1px solid #AAAAAA;
  padding: 3px 2px;
}
table.blueTable tbody td {
  font-size: 16px;
}
table.blueTable tr:nth-child(even) {
  background: #D0E4F5;
}
table.blueTable thead {
  background: #3077A4;
  background: -moz-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: -webkit-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: linear-gradient(to bottom, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  border-bottom: 2px solid #444444;
}
table.blueTable thead th {
  font-size: 15px;
  font-weight: bold;
  color: #FFFFFF;
  text-align: center;
  border-left: 2px solid #D0E4F5;
}
table.blueTable thead th:first-child {
  border-left: none;
}
table.blueTable tfoot {
  font-size: 8px;
  font-weight: bold;
  color: #FFFFFF;
  background: #D0E4F5;
  background: -moz-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: -webkit-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: linear-gradient(to bottom, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  border-top: 2px solid #444444;
}
table.blueTable tfoot td {
  font-size: 8px;
}
table.blueTable tfoot .links {
  text-align: right;
}
table.blueTable tfoot .links a{
  display: inline-block;
  background: #1C6EA4;
  color: #FFFFFF;
  padding: 2px 8px;
  border-radius: 5px;
}
body{
    background: #fff2e0;
}
.Metadata {
    margin-bottom: 15px;
}
.u-monospace {
    font-family: 'Source Code Pro',monospace;
    max-width: 100%;
    overflow-x: scroll;
    border: groove #c33b3b 2px;
}
.MetadataMessage {
    background-color: #b9caff;
    border: 1px solid #de5353;
    color: #000;
    margin: 0;
    padding: 12px;
    white-space: pre-wrap;
}
</style>
</head>
<body>

    <table class="blueTable">
     <thead>
      <tr>
       <th><strong>REVISION ID</strong></th>
       <th>SHA-1 COMMIT</th>
      </tr>
    </thead>
    <tfoot></tfoot>
     <tbody>
      <tr>
       <td><a href ="https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Mac/1257315/"> 1257315</a> <sup><b>(MAC)</b></sup></td>
       <td><a href="https://chromium.googlesource.com/chromium/src/+/cf7bc3d60a49287b826b93cdae30eee24a809911">cf7bc3d60a49287b826b93cdae30eee24a809911</a></td>
      </tr>
      <tr>
       <td><a href ="https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Win/1257310/">1257310</a> <sup><b>(WIN)</b></sup></td>
       <td><a href="https://chromium.googlesource.com/chromium/src/+/f675c16ade44012158cab3327a91ca6b2477f65f">f675c16ade44012158cab3327a91ca6b2477f65f</a></td>
     </tbody>
    </table>
   <hr><table>
 <tr>
  <th class="Metadata-title">
   commit
  </th>
  <td>
   cf7bc3d60a49287b826b93cdae30eee24a809911
  </td>
  <td>
   <span>
    [
    <a href="/chromium/src/+log/cf7bc3d60a49287b826b93cdae30eee24a809911">
     log
    </a>
    ]
   </span>
   <span>
    [
    <a href="/chromium/src/+archive/cf7bc3d60a49287b826b93cdae30eee24a809911.tar.gz">
     tgz
    </a>
    ]
   </span>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   author
  </th>
  <td>
   Sylvain Defresne &lt;sdefresne@chromium.org&gt;
  </td>
  <td>
   Wed Feb 07 14:20:48 2024
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   committer
  </th>
  <td>
   Chromium LUCI CQ &lt;chromium-scoped@luci-project-accounts.iam.gserviceaccount.com&gt;
  </td>
  <td>
   Wed Feb 07 14:20:48 2024
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   tree
  </th>
  <td>
   <a href="/chromium/src/+/cf7bc3d60a49287b826b93cdae30eee24a809911/">
    a862c107fa24c768b6f7bf8fa39e6f6860c0a478
   </a>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   parent
  </th>
  <td>
   <a href="/chromium/src/+/cf7bc3d60a49287b826b93cdae30eee24a809911%5E">
    3e21f05b56cb4919db1ad2926d018577df87d911
   </a>
   <span>
    [
    <a href="/chromium/src/+/cf7bc3d60a49287b826b93cdae30eee24a809911%5E%21/">
     diff
    </a>
    ]
   </span>
  </td>
 </tr>
</table>
<hr style="height:1px;border-width:0;color:gray;background-color:gray"><pre class="u-pre u-monospace MetadataMessage">[ios] Fix invocation of the delegate when detaching the active WebState

In WebStateList, there was a bug where the delegate is called with the
wrong WebState when detaching the active WebState and the new active
is located after the detached WebState.

The reason was that DetermineNewActiveIndex(...) returns the index of
the active WebState once the tabs have been detached, not before they
have been detached.

Fix the issue by moving the activation after the internal storage has
been updated (and thus the index is valid). Add unit tests to check
that the delegate is called with the correct WebState.

This issue may cause too many WebState to become realised (as the UI
will eventually force the realisation of the active WebState).

Bug: none
Change-Id: <a href="https://chromium-review.googlesource.com/#/q/If5007febce8aa6f17ed30f8e7f504240889a27c5">If5007febce8aa6f17ed30f8e7f504240889a27c5</a>
Reviewed-on: <a href="https://chromium-review.googlesource.com/c/chromium/src/+/5268261">https://chromium-review.googlesource.com/c/chromium/src/+/5268261</a>
Reviewed-by: Asami Doi &lt;asamidoi@chromium.org&gt;
Auto-Submit: Sylvain Defresne &lt;sdefresne@chromium.org&gt;
Commit-Queue: Sylvain Defresne &lt;sdefresne@chromium.org&gt;
Cr-Commit-Position: refs/heads/main@{#1257315}
</pre>

</body>
</html>
