<!DOCTYPE html>
<html>
<head>
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta content="utf-8" http-equiv="encoding">
<base href="https://chromium.googlesource.com/">
<style type="text/css">
table.blueTable {
  border: 1px solid #1C6EA4;
  background-color: #EEEEEE;
  width: 100%;
  text-align: center;
  border-collapse: collapse;
}
table.blueTable td, table.blueTable th {
  border: 1px solid #AAAAAA;
  padding: 3px 2px;
}
table.blueTable tbody td {
  font-size: 16px;
}
table.blueTable tr:nth-child(even) {
  background: #D0E4F5;
}
table.blueTable thead {
  background: #3077A4;
  background: -moz-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: -webkit-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: linear-gradient(to bottom, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  border-bottom: 2px solid #444444;
}
table.blueTable thead th {
  font-size: 15px;
  font-weight: bold;
  color: #FFFFFF;
  text-align: center;
  border-left: 2px solid #D0E4F5;
}
table.blueTable thead th:first-child {
  border-left: none;
}
table.blueTable tfoot {
  font-size: 8px;
  font-weight: bold;
  color: #FFFFFF;
  background: #D0E4F5;
  background: -moz-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: -webkit-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: linear-gradient(to bottom, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  border-top: 2px solid #444444;
}
table.blueTable tfoot td {
  font-size: 8px;
}
table.blueTable tfoot .links {
  text-align: right;
}
table.blueTable tfoot .links a{
  display: inline-block;
  background: #1C6EA4;
  color: #FFFFFF;
  padding: 2px 8px;
  border-radius: 5px;
}
body{
    background: #fff2e0;
}
.Metadata {
    margin-bottom: 15px;
}
.u-monospace {
    font-family: 'Source Code Pro',monospace;
    max-width: 100%;
    overflow-x: scroll;
    border: groove #c33b3b 2px;
}
.MetadataMessage {
    background-color: #b9caff;
    border: 1px solid #de5353;
    color: #000;
    margin: 0;
    padding: 12px;
    white-space: pre-wrap;
}
</style>
</head>
<body>

    <table class="blueTable">
     <thead>
      <tr>
       <th><strong>REVISION ID</strong></th>
       <th>SHA-1 COMMIT</th>
      </tr>
    </thead>
    <tfoot></tfoot>
     <tbody>
      <tr>
       <td><a href ="https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Mac/942272/"> 942272</a> <sup><b>(MAC)</b></sup></td>
       <td><a href="https://chromium.googlesource.com/chromium/src/+/826702f79e4cfc88e62736c37dc34bb1b622adba">826702f79e4cfc88e62736c37dc34bb1b622adba</a></td>
      </tr>
      <tr>
       <td><a href ="https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Win/942273/">942273</a> <sup><b>(WIN)</b></sup></td>
       <td><a href="https://chromium.googlesource.com/chromium/src/+/b33fcf9b8fdf172e3a50255a6ab27ce8943b78df">b33fcf9b8fdf172e3a50255a6ab27ce8943b78df</a></td>
     </tbody>
    </table>
   <hr><table>
 <tr>
  <th class="Metadata-title">
   commit
  </th>
  <td>
   826702f79e4cfc88e62736c37dc34bb1b622adba
  </td>
  <td>
   <span>
    [
    <a href="/chromium/src/+log/826702f79e4cfc88e62736c37dc34bb1b622adba">
     log
    </a>
    ]
   </span>
   <span>
    [
    <a href="/chromium/src/+archive/826702f79e4cfc88e62736c37dc34bb1b622adba.tar.gz">
     tgz
    </a>
    ]
   </span>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   author
  </th>
  <td>
   tom &lt;tluk@chromium.org&gt;
  </td>
  <td>
   Tue Nov 16 20:31:23 2021
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   committer
  </th>
  <td>
   Chromium LUCI CQ &lt;chromium-scoped@luci-project-accounts.iam.gserviceaccount.com&gt;
  </td>
  <td>
   Tue Nov 16 20:31:23 2021
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   tree
  </th>
  <td>
   <a href="/chromium/src/+/826702f79e4cfc88e62736c37dc34bb1b622adba/">
    b88e5dadc39fa04d6863a87c8e8400fcb5f8ebaf
   </a>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   parent
  </th>
  <td>
   <a href="/chromium/src/+/826702f79e4cfc88e62736c37dc34bb1b622adba%5E">
    40959c9175c93bdbf68b4a9bad5148360a1c26d3
   </a>
   <span>
    [
    <a href="/chromium/src/+/826702f79e4cfc88e62736c37dc34bb1b622adba%5E%21/">
     diff
    </a>
    ]
   </span>
  </td>
 </tr>
</table><hr style="height:1px;border-width:0;color:gray;background-color:gray"><pre class="u-pre u-monospace MetadataMessage">Remove FocusWindow() from DesktopNativeWidgetAura::InitNativeWidget()

Currently DesktopNativeWidgetAura::InitNativeWidget() will
unconditionally focus the newly created window in InitNativeWidget
irrespective of the Widget::InitParams::ShowState.

For minimized and inactive show states this would result in the newly
created window incorrectly being assigned focus and activation.

Calling FocusWindow() on the window created in InitNativeWidget()
should not be necessary as clients are expected to call
Widget::Show() (or Widget::ShowInactive()) which will will apply
activation / focus appropriately based on the show state.

This CL also addresses several downstream breakages as a result of
this change. Previously DNWA::HandleActivationChanged() would call
NativeWidgetDelegate::OnNativeWidgetActivationChanged() as the first
call in the method.

However at this point the FocusController has not been updated with
the new active window. As a result, code that responds to the call
to OnNativeWidgetActivationChanged() would see an inconsistent
FocusController, leading to potentially incorrect behavior.

This CL splits OnNativeWidgetActivationChanged() into two methods, one
for the check that determines if the activation change should be
handled and the other that propagates the activation change
notification to delegates.

The latter has been moved to the end of DNWA::HandleActivationChanged()
to ensure the FocusController has been appropriately updated first.

This CL also updates the test expectations for the PIP browsertest.
It seems that these expectations were set to work around the
DesktopNativeWidgetAura incorrectly setting window activation on
desktop aura platforms (See <a href="https://crrev.com/c/1363204">https://crrev.com/c/1363204</a>).

Bug: 1253925
Change-Id: <a href="https://chromium-review.googlesource.com/#/q/I7167dfb799393b6c4d4658c0c2b048ac27fb3f58">I7167dfb799393b6c4d4658c0c2b048ac27fb3f58</a>
Reviewed-on: <a href="https://chromium-review.googlesource.com/c/chromium/src/+/3267394">https://chromium-review.googlesource.com/c/chromium/src/+/3267394</a>
Reviewed-by: Scott Violet &lt;sky@chromium.org&gt;
Commit-Queue: Thomas Lukaszewicz &lt;tluk@chromium.org&gt;
Cr-Commit-Position: refs/heads/main@{#942272}
</pre>

</body>
</html>
