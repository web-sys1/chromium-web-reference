
<!DOCTYPE html>
<html>
<head>
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta content="utf-8" http-equiv="encoding">
<base href="https://chromium.googlesource.com/">
<style type="text/css">
table.blueTable {
  border: 1px solid #1C6EA4;
  background-color: #EEEEEE;
  width: 100%;
  text-align: center;
  border-collapse: collapse;
}
table.blueTable td, table.blueTable th {
  border: 1px solid #AAAAAA;
  padding: 3px 2px;
}
table.blueTable tbody td {
  font-size: 16px;
}
table.blueTable tr:nth-child(even) {
  background: #D0E4F5;
}
table.blueTable thead {
  background: #3077A4;
  background: -moz-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: -webkit-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: linear-gradient(to bottom, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  border-bottom: 2px solid #444444;
}
table.blueTable thead th {
  font-size: 15px;
  font-weight: bold;
  color: #FFFFFF;
  text-align: center;
  border-left: 2px solid #D0E4F5;
}
table.blueTable thead th:first-child {
  border-left: none;
}

table.blueTable tfoot {
  font-size: 8px;
  font-weight: bold;
  color: #FFFFFF;
  background: #D0E4F5;
  background: -moz-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: -webkit-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: linear-gradient(to bottom, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  border-top: 2px solid #444444;
}
table.blueTable tfoot td {
  font-size: 8px;
}
table.blueTable tfoot .links {
  text-align: right;
}
table.blueTable tfoot .links a{
  display: inline-block;
  background: #1C6EA4;
  color: #FFFFFF;
  padding: 2px 8px;
  border-radius: 5px;
}

body{
    background: #fff2e0;
}
.Metadata {
    margin-bottom: 15px;
}
.u-monospace {
    font-family: 'Source Code Pro',monospace;
    max-width: 100%;
    overflow-x: scroll;
    border: groove #c33b3b 2px;
}
.MetadataMessage {
    background-color: #b9caff;
    border: 1px solid #de5353;
    color: #000;
    margin: 0;
    padding: 12px;
    white-space: pre-wrap;
}
</style>
</head>
<body>

    <table class="blueTable">
     <thead>
      <tr>
       <th><strong>REVISION ID</strong></th>
       <th>SHA-1 COMMIT</th>
      </tr>
    </thead>
    <tfoot></tfoot>
     <tbody>
      <tr>
       <td>821529</td>
       <td>9c7646a388d8d16e41c84a42c3554f051b8f9f26</td>
      </tr>
     </tbody>
    </table>
   <hr><table>
 <tr>
  <th class="Metadata-title">
   commit
  </th>
  <td>
   9c7646a388d8d16e41c84a42c3554f051b8f9f26
  </td>
  <td>
   <span>
    [
    <a href="/chromium/src/+log/9c7646a388d8d16e41c84a42c3554f051b8f9f26">
     log
    </a>
    ]
   </span>
   <span>
    [
    <a href="/chromium/src/+archive/9c7646a388d8d16e41c84a42c3554f051b8f9f26.tar.gz">
     tgz
    </a>
    ]
   </span>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   author
  </th>
  <td>
   Tommy Li &lt;tommycli@chromium.org&gt;
  </td>
  <td>
   Wed Oct 28 00:47:49 2020
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   committer
  </th>
  <td>
   Commit Bot &lt;commit-bot@chromium.org&gt;
  </td>
  <td>
   Wed Oct 28 00:47:49 2020
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   tree
  </th>
  <td>
   <a href="/chromium/src/+/9c7646a388d8d16e41c84a42c3554f051b8f9f26/">
    56cd306d7adb8dca4e29fadcc76bcb32f460d5fb
   </a>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   parent
  </th>
  <td>
   <a href="/chromium/src/+/9c7646a388d8d16e41c84a42c3554f051b8f9f26%5E">
    36deecf779839598c1e9a0ec162a5811edcee9d4
   </a>
   <span>
    [
    <a href="/chromium/src/+/9c7646a388d8d16e41c84a42c3554f051b8f9f26%5E%21/">
     diff
    </a>
    ]
   </span>
  </td>
 </tr>
</table><hr style="height:1px;border-width:0;color:gray;background-color:gray"><pre class="u-pre u-monospace MetadataMessage">[search_engines] Stop undeleting Sync-deleted default search providers

Currently, when Sync tries to delete the Default Search Provider,
Chromium will uniquify the keyword by appending an underscore, and send
sync an ACTION_ADD for the deleted engine.

The CL that originally added this logic was here:
<a href="https://chromiumcodereview.appspot.com/10694096">https://chromiumcodereview.appspot.com/10694096</a>

In that CL, there's not an explicit reason why the client is sending
an ACTION_ADD to undelete the deleted entry, but I suspect this is
attempting to make sure that all clients have the same set of search
engines.

Instead, I recommend the browser ignore the ACTION_DELETE and leave the
existing search engine entry alone. It's not a big deal to have a
lingering deleted search engine in this edge case, and it's certainly
better than creating a duplicated search engine with an underscore
appended to the keyword.

If we were really extremely clever, we could mark the attempted deleted
TemplateURL as pending deletion, and then later delete it when the
default provider pref update comes in, but I think that's
over-engineering and creating potentially more problems.

Bug: 1022775
Change-Id: <a href="https://chromium-review.googlesource.com/#/q/Ibc5ab594b5506d27b32334d8f34696479c504c6c">Ibc5ab594b5506d27b32334d8f34696479c504c6c</a>
Reviewed-on: <a href="https://chromium-review.googlesource.com/c/chromium/src/+/2454833">https://chromium-review.googlesource.com/c/chromium/src/+/2454833</a>
Reviewed-by: Mark Pearson &lt;mpearson@chromium.org&gt;
Reviewed-by: Mikel Astiz &lt;mastiz@chromium.org&gt;
Commit-Queue: Tommy Li &lt;tommycli@chromium.org&gt;
Cr-Commit-Position: refs/heads/master@{#821529}
</pre>

</body>
</html>
