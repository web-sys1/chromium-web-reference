<!DOCTYPE html>
<html>
<head>
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta content="utf-8" http-equiv="encoding">
<base href="https://chromium.googlesource.com/">
<style type="text/css">
table.blueTable {
  border: 1px solid #1C6EA4;
  background-color: #EEEEEE;
  width: 100%;
  text-align: center;
  border-collapse: collapse;
}
table.blueTable td, table.blueTable th {
  border: 1px solid #AAAAAA;
  padding: 3px 2px;
}
table.blueTable tbody td {
  font-size: 16px;
}
table.blueTable tr:nth-child(even) {
  background: #D0E4F5;
}
table.blueTable thead {
  background: #3077A4;
  background: -moz-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: -webkit-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: linear-gradient(to bottom, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  border-bottom: 2px solid #444444;
}
table.blueTable thead th {
  font-size: 15px;
  font-weight: bold;
  color: #FFFFFF;
  text-align: center;
  border-left: 2px solid #D0E4F5;
}
table.blueTable thead th:first-child {
  border-left: none;
}
table.blueTable tfoot {
  font-size: 8px;
  font-weight: bold;
  color: #FFFFFF;
  background: #D0E4F5;
  background: -moz-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: -webkit-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: linear-gradient(to bottom, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  border-top: 2px solid #444444;
}
table.blueTable tfoot td {
  font-size: 8px;
}
table.blueTable tfoot .links {
  text-align: right;
}
table.blueTable tfoot .links a{
  display: inline-block;
  background: #1C6EA4;
  color: #FFFFFF;
  padding: 2px 8px;
  border-radius: 5px;
}
body{
    background: #fff2e0;
}
.Metadata {
    margin-bottom: 15px;
}
.u-monospace {
    font-family: 'Source Code Pro',monospace;
    max-width: 100%;
    overflow-x: scroll;
    border: groove #c33b3b 2px;
}
.MetadataMessage {
    background-color: #b9caff;
    border: 1px solid #de5353;
    color: #000;
    margin: 0;
    padding: 12px;
    white-space: pre-wrap;
}
</style>
</head>
<body>

    <table class="blueTable">
     <thead>
      <tr>
       <th><strong>REVISION ID</strong></th>
       <th>SHA-1 COMMIT</th>
      </tr>
    </thead>
    <tfoot></tfoot>
     <tbody>
      <tr>
       <td><a href ="https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Mac/1144497/"> 1144497</a> <sup><b>(MAC)</b></sup></td>
       <td><a href="https://chromium.googlesource.com/chromium/src/+/9ab6b5588d6ccebfb1111f10252c3b281f02fc92">9ab6b5588d6ccebfb1111f10252c3b281f02fc92</a></td>
      </tr>
      <tr>
       <td><a href ="https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Win/1144428/">1144428</a> <sup><b>(WIN)</b></sup></td>
       <td><a href="https://chromium.googlesource.com/chromium/src/+/801aec21b639149decfbf311f5fbcf417ecdda8b">801aec21b639149decfbf311f5fbcf417ecdda8b</a></td>
     </tbody>
    </table>
   <hr><table>
 <tr>
  <th class="Metadata-title">
   commit
  </th>
  <td>
   9ab6b5588d6ccebfb1111f10252c3b281f02fc92
  </td>
  <td>
   <span>
    [
    <a href="/chromium/src/+log/9ab6b5588d6ccebfb1111f10252c3b281f02fc92">
     log
    </a>
    ]
   </span>
   <span>
    [
    <a href="/chromium/src/+archive/9ab6b5588d6ccebfb1111f10252c3b281f02fc92.tar.gz">
     tgz
    </a>
    ]
   </span>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   author
  </th>
  <td>
   David Awogbemila &lt;awogbemila@chromium.org&gt;
  </td>
  <td>
   Tue May 16 00:51:08 2023
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   committer
  </th>
  <td>
   Chromium LUCI CQ &lt;chromium-scoped@luci-project-accounts.iam.gserviceaccount.com&gt;
  </td>
  <td>
   Tue May 16 00:51:08 2023
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   tree
  </th>
  <td>
   <a href="/chromium/src/+/9ab6b5588d6ccebfb1111f10252c3b281f02fc92/">
    0f8fc3af674c8b4659a2e696c560121768d6304a
   </a>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   parent
  </th>
  <td>
   <a href="/chromium/src/+/9ab6b5588d6ccebfb1111f10252c3b281f02fc92%5E">
    e1c4c8831ea45a34a825b84a74af2e1f318ad226
   </a>
   <span>
    [
    <a href="/chromium/src/+/9ab6b5588d6ccebfb1111f10252c3b281f02fc92%5E%21/">
     diff
    </a>
    ]
   </span>
  </td>
 </tr>
</table>
<hr style="height:1px;border-width:0;color:gray;background-color:gray"><pre class="u-pre u-monospace MetadataMessage">Wait for keyup to fire scrollend on key scrolls

Currently, a key scroll triggers a scroll animation which fires
scrollend when complete. This is a problem for keyboard scrolls
triggered by repeated keys because operating systems insert a delay between the
first keydown and the subsequent repeating keydown events. This means
that if this delay is large enough, the animation created for the first
keydown may finish before the second keydown event comes in and we may
fire scrollend prematurely and also fire it twice for a single keyboard
scroll.

This patch changes the way we handle scrolls generated by keyboard
events by relying on the accompanying keyup as a signal to fire
scrollend.
In some instances, the keyup may fire before the scroll actually
concludes. This patch makes sure we fire scrollend at the later of the
two.

One thing to note about this approach is that it means when a scroll
reaches the extent of the scrolling container, we will not fire
scrollend until the user releases the key. I think this is okay since it matches the behavior when dragging the scrollbar thumb.

I would have added a test that simluates the initial key repeat delay but
it appears we do not have support for keydown and keyup events in
testdriver[1] and I'm not sure if there's another way to achieve the
same effect.

[1] <a href="https://source.chromium.org/chromium/chromium/src/+/7bfdfe019b9147301e5753879f1d2824f7c3cef0:third_party/blink/web_tests/resources/testdriver-vendor.js;l=192-193">https://source.chromium.org/chromium/chromium/src/+/7bfdfe019b9147301e5753879f1d2824f7c3cef0:third_party/blink/web_tests/resources/testdriver-vendor.js;l=192-193</a>

Bug: 1400445
Change-Id: <a href="https://chromium-review.googlesource.com/#/q/I020449b3143feae112d5b4300fd841b3d1966877">I020449b3143feae112d5b4300fd841b3d1966877</a>
Reviewed-on: <a href="https://chromium-review.googlesource.com/c/chromium/src/+/4517970">https://chromium-review.googlesource.com/c/chromium/src/+/4517970</a>
Reviewed-by: Steve Kobes &lt;skobes@chromium.org&gt;
Commit-Queue: David Awogbemila &lt;awogbemila@chromium.org&gt;
Cr-Commit-Position: refs/heads/main@{#1144497}
</pre>

</body>
</html>
