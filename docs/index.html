<!DOCTYPE html>
<html>
<head>
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta content="utf-8" http-equiv="encoding">
<base href="https://chromium.googlesource.com/">
<style type="text/css">
table.blueTable {
  border: 1px solid #1C6EA4;
  background-color: #EEEEEE;
  width: 100%;
  text-align: center;
  border-collapse: collapse;
}
table.blueTable td, table.blueTable th {
  border: 1px solid #AAAAAA;
  padding: 3px 2px;
}
table.blueTable tbody td {
  font-size: 16px;
}
table.blueTable tr:nth-child(even) {
  background: #D0E4F5;
}
table.blueTable thead {
  background: #3077A4;
  background: -moz-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: -webkit-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: linear-gradient(to bottom, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  border-bottom: 2px solid #444444;
}
table.blueTable thead th {
  font-size: 15px;
  font-weight: bold;
  color: #FFFFFF;
  text-align: center;
  border-left: 2px solid #D0E4F5;
}
table.blueTable thead th:first-child {
  border-left: none;
}
table.blueTable tfoot {
  font-size: 8px;
  font-weight: bold;
  color: #FFFFFF;
  background: #D0E4F5;
  background: -moz-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: -webkit-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: linear-gradient(to bottom, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  border-top: 2px solid #444444;
}
table.blueTable tfoot td {
  font-size: 8px;
}
table.blueTable tfoot .links {
  text-align: right;
}
table.blueTable tfoot .links a{
  display: inline-block;
  background: #1C6EA4;
  color: #FFFFFF;
  padding: 2px 8px;
  border-radius: 5px;
}
body{
    background: #fff2e0;
}
.Metadata {
    margin-bottom: 15px;
}
.u-monospace {
    font-family: 'Source Code Pro',monospace;
    max-width: 100%;
    overflow-x: scroll;
    border: groove #c33b3b 2px;
}
.MetadataMessage {
    background-color: #b9caff;
    border: 1px solid #de5353;
    color: #000;
    margin: 0;
    padding: 12px;
    white-space: pre-wrap;
}
</style>
</head>
<body>

    <table class="blueTable">
     <thead>
      <tr>
       <th><strong>REVISION ID</strong></th>
       <th>SHA-1 COMMIT</th>
      </tr>
    </thead>
    <tfoot></tfoot>
     <tbody>
      <tr>
       <td><a href ="https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Mac/1099317/"> 1099317</a> <sup><b>(MAC)</b></sup></td>
       <td><a href="https://chromium.googlesource.com/chromium/src/+/51e6fc9d3c08f088b0d062f5d04c7d6b40ba7a0f">51e6fc9d3c08f088b0d062f5d04c7d6b40ba7a0f</a></td>
      </tr>
      <tr>
       <td><a href ="https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Win/1099300/">1099300</a> <sup><b>(WIN)</b></sup></td>
       <td><a href="https://chromium.googlesource.com/chromium/src/+/bfaa7208ef6e0a2255af3f66ce86a969ec6d5192">bfaa7208ef6e0a2255af3f66ce86a969ec6d5192</a></td>
     </tbody>
    </table>
   <hr><table>
 <tr>
  <th class="Metadata-title">
   commit
  </th>
  <td>
   51e6fc9d3c08f088b0d062f5d04c7d6b40ba7a0f
  </td>
  <td>
   <span>
    [
    <a href="/chromium/src/+log/51e6fc9d3c08f088b0d062f5d04c7d6b40ba7a0f">
     log
    </a>
    ]
   </span>
   <span>
    [
    <a href="/chromium/src/+archive/51e6fc9d3c08f088b0d062f5d04c7d6b40ba7a0f.tar.gz">
     tgz
    </a>
    ]
   </span>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   author
  </th>
  <td>
   Bijan Choobineh &lt;bchoobineh@chromium.org&gt;
  </td>
  <td>
   Tue Jan 31 17:38:46 2023
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   committer
  </th>
  <td>
   Chromium LUCI CQ &lt;chromium-scoped@luci-project-accounts.iam.gserviceaccount.com&gt;
  </td>
  <td>
   Tue Jan 31 17:38:46 2023
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   tree
  </th>
  <td>
   <a href="/chromium/src/+/51e6fc9d3c08f088b0d062f5d04c7d6b40ba7a0f/">
    771643da1ef58b246ec40b42edba6c659fb84f81
   </a>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   parent
  </th>
  <td>
   <a href="/chromium/src/+/51e6fc9d3c08f088b0d062f5d04c7d6b40ba7a0f%5E">
    3ab74f2603840cfae91465ded76e30264e24808e
   </a>
   <span>
    [
    <a href="/chromium/src/+/51e6fc9d3c08f088b0d062f5d04c7d6b40ba7a0f%5E%21/">
     diff
    </a>
    ]
   </span>
  </td>
 </tr>
</table><hr style="height:1px;border-width:0;color:gray;background-color:gray"><pre class="u-pre u-monospace MetadataMessage">media/gpu/v4l2/test: Implement and utilize Finish Frame function.

The H264 Decoder had previously processed bitstreams without
consideration to picture ordering. Additionally there was no prior logic
for storing pictures in the DPB for long term references.

This update implements a FinishFrame() function which builds on the
previously named SubmitSlice() function. This function will send the
remaining control structs through EXT_CTRLS indicating the end of a
frame. The function will additionally handles management of the DPB as
well as transmitting slice data according to their pic order.

This update also incorporates the FinishFrame() function into the
ProcessNextFrame() function and makes the appropriate adjustments in
that function to have logic flow based on the H264SliceMetadata instead
of a H264SliceHeader.

This update by itself will not result in any change to the decoding
results due to a bug in the DPB implementation. This issue is currently
addressed in CL:4177779. With this DPB bug fixed, this update will
result in proper decoding in over half of the bitstreams in H264_baseline.

For properly decoding all the other bitstreams, these are the next 3
items that will need to be addressed/updated.
1. Implement Picture Order Count logic for types 1 and 2 as specified in
   H264 Specification 8.2.1.2 and 8.2.1.3.
2. Implement logic for long term reference pictures.
3. Handle Memory Mgmt operations as specified in specification 8.2.5.4.

BUG=b:234752983
TEST=v4l2_stateless_decoder --video=BA1_Sony_D.h264 --md5=checksums.log
TEST=v4l2_stateless_decoder --video=BAMQ1_JVC_C.h264 --md5=checksums.log
TEST=v4l2_stateless_decoder --video=CABA1_SVA_B.h264 --md5=checksums.log

Change-Id: <a href="https://chromium-review.googlesource.com/#/q/Id6c89060039ddfe13c3efd4982fd2ac9fd51e766">Id6c89060039ddfe13c3efd4982fd2ac9fd51e766</a>
Reviewed-on: <a href="https://chromium-review.googlesource.com/c/chromium/src/+/4178263">https://chromium-review.googlesource.com/c/chromium/src/+/4178263</a>
Reviewed-by: Nathan Hebert &lt;nhebert@chromium.org&gt;
Commit-Queue: Bijan Choobinehâ€Ž &lt;bchoobineh@chromium.org&gt;
Reviewed-by: Steve Cho &lt;stevecho@chromium.org&gt;
Cr-Commit-Position: refs/heads/main@{#1099317}
</pre>

</body>
</html>
