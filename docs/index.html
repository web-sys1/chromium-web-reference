<!DOCTYPE html>
<html>
<head>
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta content="utf-8" http-equiv="encoding">
<base href="https://chromium.googlesource.com/">
<style type="text/css">
table.blueTable {
  border: 1px solid #1C6EA4;
  background-color: #EEEEEE;
  width: 100%;
  text-align: center;
  border-collapse: collapse;
}
table.blueTable td, table.blueTable th {
  border: 1px solid #AAAAAA;
  padding: 3px 2px;
}
table.blueTable tbody td {
  font-size: 16px;
}
table.blueTable tr:nth-child(even) {
  background: #D0E4F5;
}
table.blueTable thead {
  background: #3077A4;
  background: -moz-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: -webkit-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: linear-gradient(to bottom, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  border-bottom: 2px solid #444444;
}
table.blueTable thead th {
  font-size: 15px;
  font-weight: bold;
  color: #FFFFFF;
  text-align: center;
  border-left: 2px solid #D0E4F5;
}
table.blueTable thead th:first-child {
  border-left: none;
}
table.blueTable tfoot {
  font-size: 8px;
  font-weight: bold;
  color: #FFFFFF;
  background: #D0E4F5;
  background: -moz-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: -webkit-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: linear-gradient(to bottom, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  border-top: 2px solid #444444;
}
table.blueTable tfoot td {
  font-size: 8px;
}
table.blueTable tfoot .links {
  text-align: right;
}
table.blueTable tfoot .links a{
  display: inline-block;
  background: #1C6EA4;
  color: #FFFFFF;
  padding: 2px 8px;
  border-radius: 5px;
}
body{
    background: #fff2e0;
}
.Metadata {
    margin-bottom: 15px;
}
.u-monospace {
    font-family: 'Source Code Pro',monospace;
    max-width: 100%;
    overflow-x: scroll;
    border: groove #c33b3b 2px;
}
.MetadataMessage {
    background-color: #b9caff;
    border: 1px solid #de5353;
    color: #000;
    margin: 0;
    padding: 12px;
    white-space: pre-wrap;
}
</style>
</head>
<body>

    <table class="blueTable">
     <thead>
      <tr>
       <th><strong>REVISION ID</strong></th>
       <th>SHA-1 COMMIT</th>
      </tr>
    </thead>
    <tfoot></tfoot>
     <tbody>
      <tr>
       <td><a href ="https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Mac/867155/"> 867155</a> <sup><b>(MAC)</b></sup></td>
       <td><a href="https://chromium.googlesource.com/chromium/src/+/0771a936188a7b81ee7107700d360feb055c9d74">0771a936188a7b81ee7107700d360feb055c9d74</a></td>
      </tr>
      <tr>
       <td><a href ="https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Win/867161/">867161</a> <sup><b>(WIN)</b></sup></td>
       <td><a href="https://chromium.googlesource.com/chromium/src/+/b381e9a48e6eaf3ef57779de86277b9901288f69">b381e9a48e6eaf3ef57779de86277b9901288f69</a></td>
     </tbody>
    </table>
   <hr><table>
 <tr>
  <th class="Metadata-title">
   commit
  </th>
  <td>
   0771a936188a7b81ee7107700d360feb055c9d74
  </td>
  <td>
   <span>
    [
    <a href="/chromium/src/+log/0771a936188a7b81ee7107700d360feb055c9d74">
     log
    </a>
    ]
   </span>
   <span>
    [
    <a href="/chromium/src/+archive/0771a936188a7b81ee7107700d360feb055c9d74.tar.gz">
     tgz
    </a>
    ]
   </span>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   author
  </th>
  <td>
   Henrik Boström &lt;hbos@chromium.org&gt;
  </td>
  <td>
   Mon Mar 29 09:47:47 2021
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   committer
  </th>
  <td>
   Chromium LUCI CQ &lt;chromium-scoped@luci-project-accounts.iam.gserviceaccount.com&gt;
  </td>
  <td>
   Mon Mar 29 09:47:47 2021
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   tree
  </th>
  <td>
   <a href="/chromium/src/+/0771a936188a7b81ee7107700d360feb055c9d74/">
    045bea8ea23773f3b20407c33d54ae0f5600a70d
   </a>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   parent
  </th>
  <td>
   <a href="/chromium/src/+/0771a936188a7b81ee7107700d360feb055c9d74%5E">
    4067a4caa17030abf37f1903e76720506d4c6242
   </a>
   <span>
    [
    <a href="/chromium/src/+/0771a936188a7b81ee7107700d360feb055c9d74%5E%21/">
     diff
    </a>
    ]
   </span>
  </td>
 </tr>
</table><hr style="height:1px;border-width:0;color:gray;background-color:gray"><pre class="u-pre u-monospace MetadataMessage">WebRtcVideoFrameAdapter: Fix bug in GetOrWrapFrameForSize().

Prior to this CL, GetOrWrapFrameForSize() contained an early-return if
"size == full_size_". The reasoning was that if no additional scaling
had been applied to the adapter then there's no need to look at the
scaled_frames_ because we should just go ahead and map frame_.

This failed to take into account the fact that frame_ could have
soft-applied scaling, where the natural size is less than the coded
size. In this case, even though "size == full_size_", the
requested_scale_factor is not 1.0 and as such the best frame to map
might be one of the scaled_frames_.

A unit test is added where the soft-applied scaling of a 720p frame to
360p size results in a requested_scale_factor of 0.5 so that the best
buffer to map is the 360p buffer. This would have hit the early return
and fail the test, but we now pass that test.

Bug: chromium:1157072
Change-Id: <a href="https://chromium-review.googlesource.com/#/q/I1c3ff826c55a5d6a23954dd43204ed73c620ff33">I1c3ff826c55a5d6a23954dd43204ed73c620ff33</a>
Reviewed-on: <a href="https://chromium-review.googlesource.com/c/chromium/src/+/2786945">https://chromium-review.googlesource.com/c/chromium/src/+/2786945</a>
Reviewed-by: Ilya Nikolaevskiy &lt;ilnik@chromium.org&gt;
Reviewed-by: Evan Shrubsole &lt;eshr@google.com&gt;
Commit-Queue: Henrik Boström &lt;hbos@chromium.org&gt;
Cr-Commit-Position: refs/heads/master@{#867155}
</pre>

</body>
</html>
