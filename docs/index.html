<!DOCTYPE html>
<html>
<head>
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta content="utf-8" http-equiv="encoding">
<base href="https://chromium.googlesource.com/">
<style type="text/css">
table.blueTable {
  border: 1px solid #1C6EA4;
  background-color: #EEEEEE;
  width: 100%;
  text-align: center;
  border-collapse: collapse;
}
table.blueTable td, table.blueTable th {
  border: 1px solid #AAAAAA;
  padding: 3px 2px;
}
table.blueTable tbody td {
  font-size: 16px;
}
table.blueTable tr:nth-child(even) {
  background: #D0E4F5;
}
table.blueTable thead {
  background: #3077A4;
  background: -moz-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: -webkit-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: linear-gradient(to bottom, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  border-bottom: 2px solid #444444;
}
table.blueTable thead th {
  font-size: 15px;
  font-weight: bold;
  color: #FFFFFF;
  text-align: center;
  border-left: 2px solid #D0E4F5;
}
table.blueTable thead th:first-child {
  border-left: none;
}
table.blueTable tfoot {
  font-size: 8px;
  font-weight: bold;
  color: #FFFFFF;
  background: #D0E4F5;
  background: -moz-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: -webkit-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: linear-gradient(to bottom, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  border-top: 2px solid #444444;
}
table.blueTable tfoot td {
  font-size: 8px;
}
table.blueTable tfoot .links {
  text-align: right;
}
table.blueTable tfoot .links a{
  display: inline-block;
  background: #1C6EA4;
  color: #FFFFFF;
  padding: 2px 8px;
  border-radius: 5px;
}
body{
    background: #fff2e0;
}
.Metadata {
    margin-bottom: 15px;
}
.u-monospace {
    font-family: 'Source Code Pro',monospace;
    max-width: 100%;
    overflow-x: scroll;
    border: groove #c33b3b 2px;
}
.MetadataMessage {
    background-color: #b9caff;
    border: 1px solid #de5353;
    color: #000;
    margin: 0;
    padding: 12px;
    white-space: pre-wrap;
}
</style>
</head>
<body>

    <table class="blueTable">
     <thead>
      <tr>
       <th><strong>REVISION ID</strong></th>
       <th>SHA-1 COMMIT</th>
      </tr>
    </thead>
    <tfoot></tfoot>
     <tbody>
      <tr>
       <td><a href ="https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Mac/963363/"> 963363</a> <sup><b>(MAC)</b></sup></td>
       <td><a href="https://chromium.googlesource.com/chromium/src/+/a2da26673f611ea0b7915996ee107af87e01c29f">a2da26673f611ea0b7915996ee107af87e01c29f</a></td>
      </tr>
      <tr>
       <td><a href ="https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Win/963355/">963355</a> <sup><b>(WIN)</b></sup></td>
       <td><a href="https://chromium.googlesource.com/chromium/src/+/948246cddcd96ae550987436fd0d3b5ef53eec3b">948246cddcd96ae550987436fd0d3b5ef53eec3b</a></td>
     </tbody>
    </table>
   <hr><table>
 <tr>
  <th class="Metadata-title">
   commit
  </th>
  <td>
   a2da26673f611ea0b7915996ee107af87e01c29f
  </td>
  <td>
   <span>
    [
    <a href="/chromium/src/+log/a2da26673f611ea0b7915996ee107af87e01c29f">
     log
    </a>
    ]
   </span>
   <span>
    [
    <a href="/chromium/src/+archive/a2da26673f611ea0b7915996ee107af87e01c29f.tar.gz">
     tgz
    </a>
    ]
   </span>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   author
  </th>
  <td>
   Devlin Cronin &lt;rdevlin.cronin@chromium.org&gt;
  </td>
  <td>
   Wed Jan 26 03:05:23 2022
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   committer
  </th>
  <td>
   Chromium LUCI CQ &lt;chromium-scoped@luci-project-accounts.iam.gserviceaccount.com&gt;
  </td>
  <td>
   Wed Jan 26 03:05:23 2022
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   tree
  </th>
  <td>
   <a href="/chromium/src/+/a2da26673f611ea0b7915996ee107af87e01c29f/">
    7bd15fd0adb4ba38da0b5477c7e2e3aed0d6f86a
   </a>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   parent
  </th>
  <td>
   <a href="/chromium/src/+/a2da26673f611ea0b7915996ee107af87e01c29f%5E">
    5f0bb5cf2cf8cd99e6637e162eedad3ce7e0ee19
   </a>
   <span>
    [
    <a href="/chromium/src/+/a2da26673f611ea0b7915996ee107af87e01c29f%5E%21/">
     diff
    </a>
    ]
   </span>
  </td>
 </tr>
</table><hr style="height:1px;border-width:0;color:gray;background-color:gray"><pre class="u-pre u-monospace MetadataMessage">[Extensions] Introduce a renderer SharedL10nMap

Introduce SharedL10nMap on the renderer side. This is a thread-safe
shared map for extension messages that can be used to get a localized
message from i18n.getMessage() or the ExtensionLocalizationPeer.

This class is thread-safe - it uses a lock to guard access to the
underlying map whenever reading or modifying it. As such, no method
directly returns the map or a reference to a value; instead, the map
handles these operations (such as substitution) internally.

While a lock here seems alarming, in practice it's not as bad as it
seems: the vast majority of the time, there will only be one thread
accessing the map at a given moment (and it doesn't have to wait). The
situation in which this doesn't hold is if a single extension has both
a DOM-based context (like tab or popup) and an active service worker
that each want to access the map at the same instant. This can happen,
but should be rare enough that the lock isn't commonly a performance
bottleneck.

This CL introduces the SharedL10nMap and wires it up for use with
i18n.getMessage() and the ExtensionLocalizationPeer, but does *not*
enable i18n.getMessage() for service workers (and, as such, this CL
should have limited functional behavior change). Service worker
support will be added in a follow-up.

Bug: 1268098
Change-Id: <a href="https://chromium-review.googlesource.com/#/q/I11b86d638a5f1588c7aa722bf602b474b7caca68">I11b86d638a5f1588c7aa722bf602b474b7caca68</a>
Reviewed-on: <a href="https://chromium-review.googlesource.com/c/chromium/src/+/3408573">https://chromium-review.googlesource.com/c/chromium/src/+/3408573</a>
Reviewed-by: David Bertoni &lt;dbertoni@chromium.org&gt;
Commit-Queue: Devlin Cronin &lt;rdevlin.cronin@chromium.org&gt;
Cr-Commit-Position: refs/heads/main@{#963363}
</pre>

</body>
</html>
