<!DOCTYPE html>
<html>
<head>
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta content="utf-8" http-equiv="encoding">
<base href="https://chromium.googlesource.com/">
<style type="text/css">
table.blueTable {
  border: 1px solid #1C6EA4;
  background-color: #EEEEEE;
  width: 100%;
  text-align: center;
  border-collapse: collapse;
}
table.blueTable td, table.blueTable th {
  border: 1px solid #AAAAAA;
  padding: 3px 2px;
}
table.blueTable tbody td {
  font-size: 16px;
}
table.blueTable tr:nth-child(even) {
  background: #D0E4F5;
}
table.blueTable thead {
  background: #3077A4;
  background: -moz-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: -webkit-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: linear-gradient(to bottom, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  border-bottom: 2px solid #444444;
}
table.blueTable thead th {
  font-size: 15px;
  font-weight: bold;
  color: #FFFFFF;
  text-align: center;
  border-left: 2px solid #D0E4F5;
}
table.blueTable thead th:first-child {
  border-left: none;
}
table.blueTable tfoot {
  font-size: 8px;
  font-weight: bold;
  color: #FFFFFF;
  background: #D0E4F5;
  background: -moz-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: -webkit-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: linear-gradient(to bottom, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  border-top: 2px solid #444444;
}
table.blueTable tfoot td {
  font-size: 8px;
}
table.blueTable tfoot .links {
  text-align: right;
}
table.blueTable tfoot .links a{
  display: inline-block;
  background: #1C6EA4;
  color: #FFFFFF;
  padding: 2px 8px;
  border-radius: 5px;
}
body{
    background: #fff2e0;
}
.Metadata {
    margin-bottom: 15px;
}
.u-monospace {
    font-family: 'Source Code Pro',monospace;
    max-width: 100%;
    overflow-x: scroll;
    border: groove #c33b3b 2px;
}
.MetadataMessage {
    background-color: #b9caff;
    border: 1px solid #de5353;
    color: #000;
    margin: 0;
    padding: 12px;
    white-space: pre-wrap;
}
</style>
</head>
<body>

    <table class="blueTable">
     <thead>
      <tr>
       <th><strong>REVISION ID</strong></th>
       <th>SHA-1 COMMIT</th>
      </tr>
    </thead>
    <tfoot></tfoot>
     <tbody>
      <tr>
       <td><a href ="https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Mac/931800/"> 931800</a> <sup><b>(MAC)</b></sup></td>
       <td><a href="https://chromium.googlesource.com/chromium/src/+/fc4cef6cba0735ecea9ad0afb86f972fa88853c9">fc4cef6cba0735ecea9ad0afb86f972fa88853c9</a></td>
      </tr>
      <tr>
       <td><a href ="https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Win/931800/">931800</a> <sup><b>(WIN)</b></sup></td>
       <td><a href="https://chromium.googlesource.com/chromium/src/+/fc4cef6cba0735ecea9ad0afb86f972fa88853c9">fc4cef6cba0735ecea9ad0afb86f972fa88853c9</a></td>
     </tbody>
    </table>
   <hr><table>
 <tr>
  <th class="Metadata-title">
   commit
  </th>
  <td>
   fc4cef6cba0735ecea9ad0afb86f972fa88853c9
  </td>
  <td>
   <span>
    [
    <a href="/chromium/src/+log/fc4cef6cba0735ecea9ad0afb86f972fa88853c9">
     log
    </a>
    ]
   </span>
   <span>
    [
    <a href="/chromium/src/+archive/fc4cef6cba0735ecea9ad0afb86f972fa88853c9.tar.gz">
     tgz
    </a>
    ]
   </span>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   author
  </th>
  <td>
   Anders Hartvoll Ruud &lt;andruud@chromium.org&gt;
  </td>
  <td>
   Fri Oct 15 00:46:25 2021
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   committer
  </th>
  <td>
   Chromium LUCI CQ &lt;chromium-scoped@luci-project-accounts.iam.gserviceaccount.com&gt;
  </td>
  <td>
   Fri Oct 15 00:46:25 2021
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   tree
  </th>
  <td>
   <a href="/chromium/src/+/fc4cef6cba0735ecea9ad0afb86f972fa88853c9/">
    ff0363d8bc742cfcdf81816652bc8d1fd9ab1b82
   </a>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   parent
  </th>
  <td>
   <a href="/chromium/src/+/fc4cef6cba0735ecea9ad0afb86f972fa88853c9%5E">
    f5cbb8d780a8646ca92995167cacce75d19d6205
   </a>
   <span>
    [
    <a href="/chromium/src/+/fc4cef6cba0735ecea9ad0afb86f972fa88853c9%5E%21/">
     diff
    </a>
    ]
   </span>
  </td>
 </tr>
</table><hr style="height:1px;border-width:0;color:gray;background-color:gray"><pre class="u-pre u-monospace MetadataMessage">Resolve colors for ComputedStyle::Border[Visually]Equal

There is currently a bug where we don't sufficiently invalidate
the color of collapsed borders when color-scheme changes.

LayoutNGTable* currently checks for the following conditions to
try to detect border color changes:

 - BorderVisuallyEqual
 - TextDecorationOrColorChanged &amp;&amp;
   HasBorderColorReferencingCurrentColor

However, BorderVisuallyEqual does not do what it says (it does not
resolve computed colors into used colors), and the
TextDecorationOrColorChanged flag is not set for color-scheme changes:
we set the NeedsPaintInvalidation flag instead, and assume that this
will be enough to repaint any colors affected by the color scheme
change. But for tables, using NeedsPaintInvalidation to regenerate
borders is not desirable, since it's an expensive operation, and we
want to avoid doing this when the flag is set for an unrelated reason.

Therefore, this CL addresses the issue by making BorderVisuallyEqual
actually resolve the colors before comparing. This should also work
for system color keywords other than currentColor. (We likely have
bugs for this as well).

 - We no longer need to check for HasBorderColorReferencingCurrentColor
   in any place we check for Border[Visually]Equal, since what we hope
   to achieve with checking that flag is now already included in
   Border[Visually]Equal.
 - LayoutObject::AdjustStyleDifference does not need to check
   HasBorderColorReferencingCurrentColor either, since
   ComputedStyle::AdjustDiffForNeedsPaintInvalidation already
   sets NeedsPaintInvalidation if !BorderVisuallyEqual.

Fixed: 1256758
Change-Id: <a href="https://chromium-review.googlesource.com/#/q/I61f8ea60d4dd886800ae9533cda90ca80141cbd0">I61f8ea60d4dd886800ae9533cda90ca80141cbd0</a>
Reviewed-on: <a href="https://chromium-review.googlesource.com/c/chromium/src/+/3222587">https://chromium-review.googlesource.com/c/chromium/src/+/3222587</a>
Reviewed-by: Aleks Totic &lt;atotic@chromium.org&gt;
Commit-Queue: Anders Hartvoll Ruud &lt;andruud@chromium.org&gt;
Cr-Commit-Position: refs/heads/main@{#931800}
</pre>

</body>
</html>
