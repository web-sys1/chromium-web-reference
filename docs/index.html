<!DOCTYPE html>
<html>
<head>
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta content="utf-8" http-equiv="encoding">
<base href="https://chromium.googlesource.com/">
<style type="text/css">
table.blueTable {
  border: 1px solid #1C6EA4;
  background-color: #EEEEEE;
  width: 100%;
  text-align: center;
  border-collapse: collapse;
}
table.blueTable td, table.blueTable th {
  border: 1px solid #AAAAAA;
  padding: 3px 2px;
}
table.blueTable tbody td {
  font-size: 16px;
}
table.blueTable tr:nth-child(even) {
  background: #D0E4F5;
}
table.blueTable thead {
  background: #3077A4;
  background: -moz-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: -webkit-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: linear-gradient(to bottom, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  border-bottom: 2px solid #444444;
}
table.blueTable thead th {
  font-size: 15px;
  font-weight: bold;
  color: #FFFFFF;
  text-align: center;
  border-left: 2px solid #D0E4F5;
}
table.blueTable thead th:first-child {
  border-left: none;
}
table.blueTable tfoot {
  font-size: 8px;
  font-weight: bold;
  color: #FFFFFF;
  background: #D0E4F5;
  background: -moz-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: -webkit-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: linear-gradient(to bottom, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  border-top: 2px solid #444444;
}
table.blueTable tfoot td {
  font-size: 8px;
}
table.blueTable tfoot .links {
  text-align: right;
}
table.blueTable tfoot .links a{
  display: inline-block;
  background: #1C6EA4;
  color: #FFFFFF;
  padding: 2px 8px;
  border-radius: 5px;
}
body{
    background: #fff2e0;
}
.Metadata {
    margin-bottom: 15px;
}
.u-monospace {
    font-family: 'Source Code Pro',monospace;
    max-width: 100%;
    overflow-x: scroll;
    border: groove #c33b3b 2px;
}
.MetadataMessage {
    background-color: #b9caff;
    border: 1px solid #de5353;
    color: #000;
    margin: 0;
    padding: 12px;
    white-space: pre-wrap;
}
</style>
</head>
<body>

    <table class="blueTable">
     <thead>
      <tr>
       <th><strong>REVISION ID</strong></th>
       <th>SHA-1 COMMIT</th>
      </tr>
    </thead>
    <tfoot></tfoot>
     <tbody>
      <tr>
       <td><a href ="https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Mac/1044921/"> 1044921</a> <sup><b>(MAC)</b></sup></td>
       <td><a href="https://chromium.googlesource.com/chromium/src/+/6d47e31f8faf45be4862c9f98481730c363ea6fd">6d47e31f8faf45be4862c9f98481730c363ea6fd</a></td>
      </tr>
      <tr>
       <td><a href ="https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Win/1044918/">1044918</a> <sup><b>(WIN)</b></sup></td>
       <td><a href="https://chromium.googlesource.com/chromium/src/+/c4c5b77c23cabd0d159926ef726d7c0eb2d3e58b">c4c5b77c23cabd0d159926ef726d7c0eb2d3e58b</a></td>
     </tbody>
    </table>
   <hr><table>
 <tr>
  <th class="Metadata-title">
   commit
  </th>
  <td>
   6d47e31f8faf45be4862c9f98481730c363ea6fd
  </td>
  <td>
   <span>
    [
    <a href="/chromium/src/+log/6d47e31f8faf45be4862c9f98481730c363ea6fd">
     log
    </a>
    ]
   </span>
   <span>
    [
    <a href="/chromium/src/+archive/6d47e31f8faf45be4862c9f98481730c363ea6fd.tar.gz">
     tgz
    </a>
    ]
   </span>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   author
  </th>
  <td>
   Mehrab N &lt;mehrab@chromium.org&gt;
  </td>
  <td>
   Fri Sep 09 03:33:01 2022
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   committer
  </th>
  <td>
   Chromium LUCI CQ &lt;chromium-scoped@luci-project-accounts.iam.gserviceaccount.com&gt;
  </td>
  <td>
   Fri Sep 09 03:33:01 2022
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   tree
  </th>
  <td>
   <a href="/chromium/src/+/6d47e31f8faf45be4862c9f98481730c363ea6fd/">
    8b66e51975450d51cb519cdd2fee3bf5a36590de
   </a>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   parent
  </th>
  <td>
   <a href="/chromium/src/+/6d47e31f8faf45be4862c9f98481730c363ea6fd%5E">
    37facbeb57424db1ef7c0ac40be4dee8091d809e
   </a>
   <span>
    [
    <a href="/chromium/src/+/6d47e31f8faf45be4862c9f98481730c363ea6fd%5E%21/">
     diff
    </a>
    ]
   </span>
  </td>
 </tr>
</table><hr style="height:1px;border-width:0;color:gray;background-color:gray"><pre class="u-pre u-monospace MetadataMessage">autocorrect: add suggestion validation

Autocorret interactions are defined based on changes in surrounding text
and autocorrect range and events related to text edit by users.
However, part of these information could be commonly stale and events
could arrive out of the order they occurred because of async delay.
Currently, the most impactful cases of the issue include:

* OnSurroundingTextChanged event for operations that commit autocorrect
  suggestion are sometimes received after handling the suggestion by
  AutocorrectManager. This happens more commonly when typing fast.
  Given there is currently no way to know if these operations are stale
  or distinguish if they are applied by a user or IMF internal
  operations, they previously would make some autocorrect suggestions
  incorrectly accepted.
* TextInputClients sometimes have delay in setting an autocorrect range
  and they might return stale range meanwhile. This previously would
  make autocorrect suggestions incorrectly rejected when the delay was
  very high.

To confront these issues, a new logic is added which first validates
that the text of OnSurroundingTextChanged includes the suggested text in
the autocorrect range of the TextInputClient. A successful validation
enables all interactions and UIs for autocorrect. To prevent unexpected
issues that can be caused by this validation, a few failed validations
will clear autocorrect suggestions to ensure that it does not remain
pending forever.

Bug: b:161490813, b:240351102
Change-Id: <a href="https://chromium-review.googlesource.com/#/q/I7a196da9c81827b822b67f4ea7666bbb2fe71eba">I7a196da9c81827b822b67f4ea7666bbb2fe71eba</a>
Reviewed-on: <a href="https://chromium-review.googlesource.com/c/chromium/src/+/3878362">https://chromium-review.googlesource.com/c/chromium/src/+/3878362</a>
Reviewed-by: Darren Shen &lt;shend@chromium.org&gt;
Commit-Queue: Mehrab N &lt;mehrab@chromium.org&gt;
Cr-Commit-Position: refs/heads/main@{#1044921}
</pre>

</body>
</html>
