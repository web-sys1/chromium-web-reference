<!DOCTYPE html>
<html>
<head>
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta content="utf-8" http-equiv="encoding">
<base href="https://chromium.googlesource.com/">
<style type="text/css">
table.blueTable {
  border: 1px solid #1C6EA4;
  background-color: #EEEEEE;
  width: 100%;
  text-align: center;
  border-collapse: collapse;
}
table.blueTable td, table.blueTable th {
  border: 1px solid #AAAAAA;
  padding: 3px 2px;
}
table.blueTable tbody td {
  font-size: 16px;
}
table.blueTable tr:nth-child(even) {
  background: #D0E4F5;
}
table.blueTable thead {
  background: #3077A4;
  background: -moz-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: -webkit-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: linear-gradient(to bottom, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  border-bottom: 2px solid #444444;
}
table.blueTable thead th {
  font-size: 15px;
  font-weight: bold;
  color: #FFFFFF;
  text-align: center;
  border-left: 2px solid #D0E4F5;
}
table.blueTable thead th:first-child {
  border-left: none;
}
table.blueTable tfoot {
  font-size: 8px;
  font-weight: bold;
  color: #FFFFFF;
  background: #D0E4F5;
  background: -moz-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: -webkit-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: linear-gradient(to bottom, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  border-top: 2px solid #444444;
}
table.blueTable tfoot td {
  font-size: 8px;
}
table.blueTable tfoot .links {
  text-align: right;
}
table.blueTable tfoot .links a{
  display: inline-block;
  background: #1C6EA4;
  color: #FFFFFF;
  padding: 2px 8px;
  border-radius: 5px;
}
body{
    background: #fff2e0;
}
.Metadata {
    margin-bottom: 15px;
}
.u-monospace {
    font-family: 'Source Code Pro',monospace;
    max-width: 100%;
    overflow-x: scroll;
    border: groove #c33b3b 2px;
}
.MetadataMessage {
    background-color: #b9caff;
    border: 1px solid #de5353;
    color: #000;
    margin: 0;
    padding: 12px;
    white-space: pre-wrap;
}
</style>
</head>
<body>

    <table class="blueTable">
     <thead>
      <tr>
       <th><strong>REVISION ID</strong></th>
       <th>SHA-1 COMMIT</th>
      </tr>
    </thead>
    <tfoot></tfoot>
     <tbody>
      <tr>
       <td><a href ="https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Mac/1470160/"> 1470160</a> <sup><b>(MAC)</b></sup></td>
       <td><a href="https://chromium.googlesource.com/chromium/src/+/4877c97e42b04eb97007643098a3a974cf6d132a">4877c97e42b04eb97007643098a3a974cf6d132a</a></td>
      </tr>
      <tr>
       <td><a href ="https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Win/1470153/">1470153</a> <sup><b>(WIN)</b></sup></td>
       <td><a href="https://chromium.googlesource.com/chromium/src/+/c9faf7c5f465f73d6b59e7bd0ac15fade8ea37a3">c9faf7c5f465f73d6b59e7bd0ac15fade8ea37a3</a></td>
     </tbody>
    </table>
   <hr><table>
 <tr>
  <th class="Metadata-title">
   commit
  </th>
  <td>
   4877c97e42b04eb97007643098a3a974cf6d132a
  </td>
  <td>
   <span>
    [
    <a href="/chromium/src/+log/4877c97e42b04eb97007643098a3a974cf6d132a">
     log
    </a>
    ]
   </span>
   <span>
    [
    <a href="/chromium/src/+archive/4877c97e42b04eb97007643098a3a974cf6d132a.tar.gz">
     tgz
    </a>
    ]
   </span>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   author
  </th>
  <td>
   Zachary Tan &lt;tanzachary@chromium.org&gt;
  </td>
  <td>
   Thu Jun 05 20:35:06 2025
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   committer
  </th>
  <td>
   Chromium LUCI CQ &lt;chromium-scoped@luci-project-accounts.iam.gserviceaccount.com&gt;
  </td>
  <td>
   Thu Jun 05 20:35:06 2025
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   tree
  </th>
  <td>
   <a href="/chromium/src/+/4877c97e42b04eb97007643098a3a974cf6d132a/">
    cb8bf5ee463491dcc277f41b4bfe8c9968dcec30
   </a>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   parent
  </th>
  <td>
   <a href="/chromium/src/+/4877c97e42b04eb97007643098a3a974cf6d132a%5E">
    e55619e33ed2dd6fe6063e97bb4c018aba15d187
   </a>
   <span>
    [
    <a href="/chromium/src/+/4877c97e42b04eb97007643098a3a974cf6d132a%5E%21/">
     diff
    </a>
    ]
   </span>
  </td>
 </tr>
</table>
<hr style="height:1px;border-width:0;color:gray;background-color:gray"><pre class="u-pre u-monospace MetadataMessage">[FedCM] Fix concurrent requests metrics recording

With the current metrics recording logic, concurrent requests reset
the FedCmMetrics object which causes metrics that should have been
associated with the initial request to be recorded along with the
request that reset it. This is not ideal because we want one metric
recorded per request.

There are 5 cases where we currently reset the FedCmMetrics object and
the new behaviors are listed here:
1. TooManyRequests: Create a new FedCmMetrics object, which is destroyed
within the same method where it is created after all relevant metrics
are recorded.
2. Disconnect: Create a new FedCmMetrics object and have the
corresponding FederatedAuthDisconnectRequest take ownership of it.
The object is destroyed once all relevant metrics are recorded.
3. Passive replaced by active mode: Create a new FedCmMetrics object.
The previous one is destroyed when the passive request is resolved. The
new FedCmMetrics object replaces the previous one.
4. Page is not primary: Doesn't reset pending request's FedCmMetrics.
Without a pending request, there's no FedCmMetrics object at this
point.
5. Multi IDP but not enabled: Doesn't reset pending request's
FedCmMetrics. Without a pending request, there's no FedCmMetrics object
at this point.

Bug: 417784830
Change-Id: <a href="https://chromium-review.googlesource.com/#/q/Iccfe998c8d9edd4cf4b840e92d788aed9b873653">Iccfe998c8d9edd4cf4b840e92d788aed9b873653</a>
Reviewed-on: <a href="https://chromium-review.googlesource.com/c/chromium/src/+/6594133">https://chromium-review.googlesource.com/c/chromium/src/+/6594133</a>
Reviewed-by: Nicolás Peña &lt;npm@chromium.org&gt;
Commit-Queue: Zachary Tan &lt;tanzachary@chromium.org&gt;
Cr-Commit-Position: refs/heads/main@{#1470160}
</pre>

</body>
</html>
