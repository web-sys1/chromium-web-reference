<!DOCTYPE html>
<html>
<head>
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta content="utf-8" http-equiv="encoding">
<base href="https://chromium.googlesource.com/">
<style type="text/css">
table.blueTable {
  border: 1px solid #1C6EA4;
  background-color: #EEEEEE;
  width: 100%;
  text-align: center;
  border-collapse: collapse;
}
table.blueTable td, table.blueTable th {
  border: 1px solid #AAAAAA;
  padding: 3px 2px;
}
table.blueTable tbody td {
  font-size: 16px;
}
table.blueTable tr:nth-child(even) {
  background: #D0E4F5;
}
table.blueTable thead {
  background: #3077A4;
  background: -moz-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: -webkit-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: linear-gradient(to bottom, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  border-bottom: 2px solid #444444;
}
table.blueTable thead th {
  font-size: 15px;
  font-weight: bold;
  color: #FFFFFF;
  text-align: center;
  border-left: 2px solid #D0E4F5;
}
table.blueTable thead th:first-child {
  border-left: none;
}
table.blueTable tfoot {
  font-size: 8px;
  font-weight: bold;
  color: #FFFFFF;
  background: #D0E4F5;
  background: -moz-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: -webkit-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: linear-gradient(to bottom, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  border-top: 2px solid #444444;
}
table.blueTable tfoot td {
  font-size: 8px;
}
table.blueTable tfoot .links {
  text-align: right;
}
table.blueTable tfoot .links a{
  display: inline-block;
  background: #1C6EA4;
  color: #FFFFFF;
  padding: 2px 8px;
  border-radius: 5px;
}
body{
    background: #fff2e0;
}
.Metadata {
    margin-bottom: 15px;
}
.u-monospace {
    font-family: 'Source Code Pro',monospace;
    max-width: 100%;
    overflow-x: scroll;
    border: groove #c33b3b 2px;
}
.MetadataMessage {
    background-color: #b9caff;
    border: 1px solid #de5353;
    color: #000;
    margin: 0;
    padding: 12px;
    white-space: pre-wrap;
}
</style>
</head>
<body>

    <table class="blueTable">
     <thead>
      <tr>
       <th><strong>REVISION ID</strong></th>
       <th>SHA-1 COMMIT</th>
      </tr>
    </thead>
    <tfoot></tfoot>
     <tbody>
      <tr>
       <td><a href ="https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Mac/1030148/"> 1030148</a> <sup><b>(MAC)</b></sup></td>
       <td><a href="https://chromium.googlesource.com/chromium/src/+/4349742ede6f0f280f8d09ef7cae98cbdfbaf53c">4349742ede6f0f280f8d09ef7cae98cbdfbaf53c</a></td>
      </tr>
      <tr>
       <td><a href ="https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Win/1030099/">1030099</a> <sup><b>(WIN)</b></sup></td>
       <td><a href="https://chromium.googlesource.com/chromium/src/+/fa4cb38fe542ff5908189b24d1c33cbf740537d0">fa4cb38fe542ff5908189b24d1c33cbf740537d0</a></td>
     </tbody>
    </table>
   <hr><table>
 <tr>
  <th class="Metadata-title">
   commit
  </th>
  <td>
   4349742ede6f0f280f8d09ef7cae98cbdfbaf53c
  </td>
  <td>
   <span>
    [
    <a href="/chromium/src/+log/4349742ede6f0f280f8d09ef7cae98cbdfbaf53c">
     log
    </a>
    ]
   </span>
   <span>
    [
    <a href="/chromium/src/+archive/4349742ede6f0f280f8d09ef7cae98cbdfbaf53c.tar.gz">
     tgz
    </a>
    ]
   </span>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   author
  </th>
  <td>
   Duncan Mercer &lt;mercerd@google.com&gt;
  </td>
  <td>
   Mon Aug 01 16:55:56 2022
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   committer
  </th>
  <td>
   Chromium LUCI CQ &lt;chromium-scoped@luci-project-accounts.iam.gserviceaccount.com&gt;
  </td>
  <td>
   Mon Aug 01 16:55:56 2022
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   tree
  </th>
  <td>
   <a href="/chromium/src/+/4349742ede6f0f280f8d09ef7cae98cbdfbaf53c/">
    dc3ab3a2cb43527717b2f4c83b777cfd0b401dd0
   </a>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   parent
  </th>
  <td>
   <a href="/chromium/src/+/4349742ede6f0f280f8d09ef7cae98cbdfbaf53c%5E">
    5eb13a183fbec79002d109e579dd2066a423a70c
   </a>
   <span>
    [
    <a href="/chromium/src/+/4349742ede6f0f280f8d09ef7cae98cbdfbaf53c%5E%21/">
     diff
    </a>
    ]
   </span>
  </td>
 </tr>
</table><hr style="height:1px;border-width:0;color:gray;background-color:gray"><pre class="u-pre u-monospace MetadataMessage">Fixed bug causing page to sometimes not render correctly with side panel v2.

This change is similar to <a href="https://chromium-review.googlesource.com/c/chromium/src/+/3792486">https://chromium-review.googlesource.com/c/chromium/src/+/3792486</a> but is the fix for Side Panel V2. The main difference between this change and the Side Panel v1 fix is the coordinator does not own the side panel view, so I had to make the side panel view be responsible for rendering the page only when it is safe to do so.

This change fixes a bug that was causing a race condition within Lens Web. This bug was being caused by WebContents being 0px by 0px. This would cause Lens Web to start rendering as if the viewport was 0px wide and 0px tall. Most the times this was fixed by a resize event, but if the javascript wasn't loaded yet, the webpage would miss the resize event and not rerender. To fix this, we now manually wait until side panel has a width, and set the WebContents to the same dimensions as side panel before trying to render Lens Web. This fixes two bugs, one that in unlikely cases, caused the page to completely break when rendering and show no image. Another bug is fixed by this change that was causing the initial region search to not render and instead would render as a blue, unclickable gleam.

TESTED: Manually tested that the blue dot gleams no longer appear on first render in Side Panel V2. Also was unable to get the page to fail to render after fix, but will manually verify again in canary. I checked image search and region search to ensure they both are working properly. Also tested that both still work if side panel starts closed or starts open.
Bug: b:231610810, b:240270069
Change-Id: <a href="https://chromium-review.googlesource.com/#/q/I63cee566beb208d7d8af4eba48e29631a9571f28">I63cee566beb208d7d8af4eba48e29631a9571f28</a>
Reviewed-on: <a href="https://chromium-review.googlesource.com/c/chromium/src/+/3794605">https://chromium-review.googlesource.com/c/chromium/src/+/3794605</a>
Commit-Queue: Duncan Mercer &lt;mercerd@google.com&gt;
Reviewed-by: Thomas Lukaszewicz &lt;tluk@chromium.org&gt;
Reviewed-by: Tom Lukaszewicz &lt;tluk@google.com&gt;
Cr-Commit-Position: refs/heads/main@{#1030148}
</pre>

</body>
</html>
