<!DOCTYPE html>
<html>
<head>
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta content="utf-8" http-equiv="encoding">
<base href="https://chromium.googlesource.com/">
<style type="text/css">
table.blueTable {
  border: 1px solid #1C6EA4;
  background-color: #EEEEEE;
  width: 100%;
  text-align: center;
  border-collapse: collapse;
}
table.blueTable td, table.blueTable th {
  border: 1px solid #AAAAAA;
  padding: 3px 2px;
}
table.blueTable tbody td {
  font-size: 16px;
}
table.blueTable tr:nth-child(even) {
  background: #D0E4F5;
}
table.blueTable thead {
  background: #3077A4;
  background: -moz-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: -webkit-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: linear-gradient(to bottom, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  border-bottom: 2px solid #444444;
}
table.blueTable thead th {
  font-size: 15px;
  font-weight: bold;
  color: #FFFFFF;
  text-align: center;
  border-left: 2px solid #D0E4F5;
}
table.blueTable thead th:first-child {
  border-left: none;
}
table.blueTable tfoot {
  font-size: 8px;
  font-weight: bold;
  color: #FFFFFF;
  background: #D0E4F5;
  background: -moz-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: -webkit-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: linear-gradient(to bottom, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  border-top: 2px solid #444444;
}
table.blueTable tfoot td {
  font-size: 8px;
}
table.blueTable tfoot .links {
  text-align: right;
}
table.blueTable tfoot .links a{
  display: inline-block;
  background: #1C6EA4;
  color: #FFFFFF;
  padding: 2px 8px;
  border-radius: 5px;
}
body{
    background: #fff2e0;
}
.Metadata {
    margin-bottom: 15px;
}
.u-monospace {
    font-family: 'Source Code Pro',monospace;
    max-width: 100%;
    overflow-x: scroll;
    border: groove #c33b3b 2px;
}
.MetadataMessage {
    background-color: #b9caff;
    border: 1px solid #de5353;
    color: #000;
    margin: 0;
    padding: 12px;
    white-space: pre-wrap;
}
</style>
</head>
<body>

    <table class="blueTable">
     <thead>
      <tr>
       <th><strong>REVISION ID</strong></th>
       <th>SHA-1 COMMIT</th>
      </tr>
    </thead>
    <tfoot></tfoot>
     <tbody>
      <tr>
       <td><a href ="https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Mac/1181803/"> 1181803</a> <sup><b>(MAC)</b></sup></td>
       <td><a href="https://chromium.googlesource.com/chromium/src/+/dbf58c92a7bbc184d831afde39ac93cc8ff493bc">dbf58c92a7bbc184d831afde39ac93cc8ff493bc</a></td>
      </tr>
      <tr>
       <td><a href ="https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Win/1181749/">1181749</a> <sup><b>(WIN)</b></sup></td>
       <td><a href="https://chromium.googlesource.com/chromium/src/+/38a33899954a39079c9ccfd657f1e50ffa98ec4c">38a33899954a39079c9ccfd657f1e50ffa98ec4c</a></td>
     </tbody>
    </table>
   <hr><table>
 <tr>
  <th class="Metadata-title">
   commit
  </th>
  <td>
   dbf58c92a7bbc184d831afde39ac93cc8ff493bc
  </td>
  <td>
   <span>
    [
    <a href="/chromium/src/+log/dbf58c92a7bbc184d831afde39ac93cc8ff493bc">
     log
    </a>
    ]
   </span>
   <span>
    [
    <a href="/chromium/src/+archive/dbf58c92a7bbc184d831afde39ac93cc8ff493bc.tar.gz">
     tgz
    </a>
    ]
   </span>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   author
  </th>
  <td>
   Mason Freed &lt;masonf@chromium.org&gt;
  </td>
  <td>
   Thu Aug 10 00:51:23 2023
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   committer
  </th>
  <td>
   Chromium LUCI CQ &lt;chromium-scoped@luci-project-accounts.iam.gserviceaccount.com&gt;
  </td>
  <td>
   Thu Aug 10 00:51:23 2023
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   tree
  </th>
  <td>
   <a href="/chromium/src/+/dbf58c92a7bbc184d831afde39ac93cc8ff493bc/">
    86696e803bc52ba85bfc86040f45e9b6aca2ddb8
   </a>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   parent
  </th>
  <td>
   <a href="/chromium/src/+/dbf58c92a7bbc184d831afde39ac93cc8ff493bc%5E">
    e77bf0a980537d28b9d2ee617df5c2e3440fa7b1
   </a>
   <span>
    [
    <a href="/chromium/src/+/dbf58c92a7bbc184d831afde39ac93cc8ff493bc%5E%21/">
     diff
    </a>
    ]
   </span>
  </td>
 </tr>
</table>
<hr style="height:1px;border-width:0;color:gray;background-color:gray"><pre class="u-pre u-monospace MetadataMessage">DOM Parts speed optimization patch 3/N

This CL revamps several larger parts of DOM Parts:
 - The PartRoot no longer maintains a list of unsorted parts. It
   maintains a cache which is in sorted order, if it exists. If the
   cache is dirty, then a call to getParts() will walk the full
   sub-tree and collect the cached Parts.
 - Several techniques are used to maintain the cache and keep it from
   getting dirty:
     1. A NodeMoveScope is used to maintain state during DOM tree moves
        such as AppendNode or InsertBefore.
     2. As Nodes are moved, if they can be removed from old PartRoots
        or added to new PartRoots while maintaining the cache
        correctness, that will be done. This uses information from
        the NodeMoveScope.
     3. This process is now also used to maintain the cache during a
        Clone.
     4. When walking the tree to re-collect Parts, each PartRoot now
        returns a FirstIncludedChildNode and LastIncludedChildNode so
        that the walk can be scoped to this sub-tree.
     5. The cached Part list is now stored as a HeapDeque rather than
        a HeapHashSet, and DCHECKs ensure that we don't ever need to
        search the cache for a Part, so the HashSet isn't needed.
     6. getParts() now returns a reference rather than a copy.

These changes are covered by the existing basic-dom-part-objects.tentative.html test.

Bug: 1453291
Change-Id: <a href="https://chromium-review.googlesource.com/#/q/I49f027e48485165f48719dc1f8d54cd21b23fa20">I49f027e48485165f48719dc1f8d54cd21b23fa20</a>
Reviewed-on: <a href="https://chromium-review.googlesource.com/c/chromium/src/+/4764270">https://chromium-review.googlesource.com/c/chromium/src/+/4764270</a>
Auto-Submit: Mason Freed &lt;masonf@chromium.org&gt;
Reviewed-by: Joey Arhar &lt;jarhar@chromium.org&gt;
Commit-Queue: Mason Freed &lt;masonf@chromium.org&gt;
Cr-Commit-Position: refs/heads/main@{#1181803}
</pre>

</body>
</html>
