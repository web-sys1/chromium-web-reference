
<!DOCTYPE html>
<html>
<head>
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta content="utf-8" http-equiv="encoding">
<base href="https://chromium.googlesource.com/">
<style type="text/css">
table.blueTable {
  border: 1px solid #1C6EA4;
  background-color: #EEEEEE;
  width: 100%;
  text-align: center;
  border-collapse: collapse;
}
table.blueTable td, table.blueTable th {
  border: 1px solid #AAAAAA;
  padding: 3px 2px;
}
table.blueTable tbody td {
  font-size: 16px;
}
table.blueTable tr:nth-child(even) {
  background: #D0E4F5;
}
table.blueTable thead {
  background: #3077A4;
  background: -moz-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: -webkit-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: linear-gradient(to bottom, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  border-bottom: 2px solid #444444;
}
table.blueTable thead th {
  font-size: 15px;
  font-weight: bold;
  color: #FFFFFF;
  text-align: center;
  border-left: 2px solid #D0E4F5;
}
table.blueTable thead th:first-child {
  border-left: none;
}

table.blueTable tfoot {
  font-size: 8px;
  font-weight: bold;
  color: #FFFFFF;
  background: #D0E4F5;
  background: -moz-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: -webkit-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: linear-gradient(to bottom, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  border-top: 2px solid #444444;
}
table.blueTable tfoot td {
  font-size: 8px;
}
table.blueTable tfoot .links {
  text-align: right;
}
table.blueTable tfoot .links a{
  display: inline-block;
  background: #1C6EA4;
  color: #FFFFFF;
  padding: 2px 8px;
  border-radius: 5px;
}

body{
    background: #fff2e0;
}
.Metadata {
    margin-bottom: 15px;
}
.u-monospace {
    font-family: 'Source Code Pro',monospace;
    max-width: 100%;
    overflow-x: scroll;
    border: groove #c33b3b 2px;
}
.MetadataMessage {
    background-color: #b9caff;
    border: 1px solid #de5353;
    color: #000;
    margin: 0;
    padding: 12px;
    white-space: pre-wrap;
}
</style>
</head>
<body>

    <table class="blueTable">
     <thead>
      <tr>
       <th><strong>REVISION ID</strong></th>
       <th>SHA-1 COMMIT</th>
      </tr>
    </thead>
    <tfoot></tfoot>
     <tbody>
      <tr>
       <td>822052</td>
       <td>e9d65d29181633f5c29f8b6db6c72f9bbf8e7d8b</td>
      </tr>
     </tbody>
    </table>
   <hr><table>
 <tr>
  <th class="Metadata-title">
   commit
  </th>
  <td>
   e9d65d29181633f5c29f8b6db6c72f9bbf8e7d8b
  </td>
  <td>
   <span>
    [
    <a href="/chromium/src/+log/e9d65d29181633f5c29f8b6db6c72f9bbf8e7d8b">
     log
    </a>
    ]
   </span>
   <span>
    [
    <a href="/chromium/src/+archive/e9d65d29181633f5c29f8b6db6c72f9bbf8e7d8b.tar.gz">
     tgz
    </a>
    ]
   </span>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   author
  </th>
  <td>
   Samuel Attard &lt;samuel.r.attard@gmail.com&gt;
  </td>
  <td>
   Thu Oct 29 06:11:47 2020
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   committer
  </th>
  <td>
   Commit Bot &lt;commit-bot@chromium.org&gt;
  </td>
  <td>
   Thu Oct 29 06:11:47 2020
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   tree
  </th>
  <td>
   <a href="/chromium/src/+/e9d65d29181633f5c29f8b6db6c72f9bbf8e7d8b/">
    297e6a333f545b7fd2b0e69a7d826fdddfc2a297
   </a>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   parent
  </th>
  <td>
   <a href="/chromium/src/+/e9d65d29181633f5c29f8b6db6c72f9bbf8e7d8b%5E">
    2f6d9f2b01aee3226296a7b0efa12b9d9b86d2bc
   </a>
   <span>
    [
    <a href="/chromium/src/+/e9d65d29181633f5c29f8b6db6c72f9bbf8e7d8b%5E%21/">
     diff
    </a>
    ]
   </span>
  </td>
 </tr>
</table><hr style="height:1px;border-width:0;color:gray;background-color:gray"><pre class="u-pre u-monospace MetadataMessage">swap global proxies before initializing the windows proxies

Electron's Context Isolation implementation has a side-effect of
initializing the isolated worlds WindowProxy during the initialization
of the main world WindowProxy as a result of creating the isolated
world inside the DidCreateScriptContext hook.  This results in an
assertion failing in Chromium during a frame swap where it expects to
be able to set a new global_proxy in the WindowProxy of the isolated
world BEFORE it is initialized.

To meet this assumption this patch splits SetGlobalProxy into two
calls, SetGlobalProxyWithoutInitializing and InitializeIfNeeded which
has the same resultant effect but means that all of the global_proxy
objects are set BEFORE any WindowProxy's are initialized.

To further clarify, if an embedder creates and initializes new script
context as a result of a call to DidCreateScriptContext the
"global_proxy_.IsEmpty()" CHECK fails as it doesn't expect that context
to have been initialized yet.

Change-Id: <a href="https://chromium-review.googlesource.com/#/q/I0efa579a4ec2d93369f3e1fc7a922a459a2300cf">I0efa579a4ec2d93369f3e1fc7a922a459a2300cf</a>
Reviewed-on: <a href="https://chromium-review.googlesource.com/c/chromium/src/+/2503397">https://chromium-review.googlesource.com/c/chromium/src/+/2503397</a>
Reviewed-by: Daniel Cheng &lt;dcheng@chromium.org&gt;
Reviewed-by: Yuki Shiino &lt;yukishiino@chromium.org&gt;
Commit-Queue: Yuki Shiino &lt;yukishiino@chromium.org&gt;
Cr-Commit-Position: refs/heads/master@{#822052}
</pre>

</body>
</html>
