<!DOCTYPE html>
<html>
<head>
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta content="utf-8" http-equiv="encoding">
<base href="https://chromium.googlesource.com/">
<style type="text/css">
table.blueTable {
  border: 1px solid #1C6EA4;
  background-color: #EEEEEE;
  width: 100%;
  text-align: center;
  border-collapse: collapse;
}
table.blueTable td, table.blueTable th {
  border: 1px solid #AAAAAA;
  padding: 3px 2px;
}
table.blueTable tbody td {
  font-size: 16px;
}
table.blueTable tr:nth-child(even) {
  background: #D0E4F5;
}
table.blueTable thead {
  background: #3077A4;
  background: -moz-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: -webkit-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: linear-gradient(to bottom, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  border-bottom: 2px solid #444444;
}
table.blueTable thead th {
  font-size: 15px;
  font-weight: bold;
  color: #FFFFFF;
  text-align: center;
  border-left: 2px solid #D0E4F5;
}
table.blueTable thead th:first-child {
  border-left: none;
}
table.blueTable tfoot {
  font-size: 8px;
  font-weight: bold;
  color: #FFFFFF;
  background: #D0E4F5;
  background: -moz-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: -webkit-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: linear-gradient(to bottom, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  border-top: 2px solid #444444;
}
table.blueTable tfoot td {
  font-size: 8px;
}
table.blueTable tfoot .links {
  text-align: right;
}
table.blueTable tfoot .links a{
  display: inline-block;
  background: #1C6EA4;
  color: #FFFFFF;
  padding: 2px 8px;
  border-radius: 5px;
}
body{
    background: #fff2e0;
}
.Metadata {
    margin-bottom: 15px;
}
.u-monospace {
    font-family: 'Source Code Pro',monospace;
    max-width: 100%;
    overflow-x: scroll;
    border: groove #c33b3b 2px;
}
.MetadataMessage {
    background-color: #b9caff;
    border: 1px solid #de5353;
    color: #000;
    margin: 0;
    padding: 12px;
    white-space: pre-wrap;
}
</style>
</head>
<body>

    <table class="blueTable">
     <thead>
      <tr>
       <th><strong>REVISION ID</strong></th>
       <th>SHA-1 COMMIT</th>
      </tr>
    </thead>
    <tfoot></tfoot>
     <tbody>
      <tr>
       <td><a href ="https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Mac/858775/"> 858775</a> <sup><b>(MAC)</b></sup></td>
       <td><a href="https://chromium.googlesource.com/chromium/src/+/c41080a7c462ce0e5fc772f6c5e4959e4fbbeb30">c41080a7c462ce0e5fc772f6c5e4959e4fbbeb30</a></td>
      </tr>
      <tr>
       <td><a href ="https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Win/858692/">858692</a> <sup><b>(WIN)</b></sup></td>
       <td><a href="https://chromium.googlesource.com/chromium/src/+/c2c140b8383bca3702508f549bd2890ce47cb079">c2c140b8383bca3702508f549bd2890ce47cb079</a></td>
     </tbody>
    </table>
   <hr><table>
 <tr>
  <th class="Metadata-title">
   commit
  </th>
  <td>
   c41080a7c462ce0e5fc772f6c5e4959e4fbbeb30
  </td>
  <td>
   <span>
    [
    <a href="/chromium/src/+log/c41080a7c462ce0e5fc772f6c5e4959e4fbbeb30">
     log
    </a>
    ]
   </span>
   <span>
    [
    <a href="/chromium/src/+archive/c41080a7c462ce0e5fc772f6c5e4959e4fbbeb30.tar.gz">
     tgz
    </a>
    ]
   </span>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   author
  </th>
  <td>
   Alex Newcomer &lt;newcomer@chromium.org&gt;
  </td>
  <td>
   Tue Mar 02 00:11:21 2021
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   committer
  </th>
  <td>
   Chromium LUCI CQ &lt;chromium-scoped@luci-project-accounts.iam.gserviceaccount.com&gt;
  </td>
  <td>
   Tue Mar 02 00:11:21 2021
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   tree
  </th>
  <td>
   <a href="/chromium/src/+/c41080a7c462ce0e5fc772f6c5e4959e4fbbeb30/">
    a8e4913f308a8780700a8283c54c7bc7b2715570
   </a>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   parent
  </th>
  <td>
   <a href="/chromium/src/+/c41080a7c462ce0e5fc772f6c5e4959e4fbbeb30%5E">
    0fb2441b925bbcad9d202585cc91e0d66e86d6ca
   </a>
   <span>
    [
    <a href="/chromium/src/+/c41080a7c462ce0e5fc772f6c5e4959e4fbbeb30%5E%21/">
     diff
    </a>
    ]
   </span>
  </td>
 </tr>
</table><hr style="height:1px;border-width:0;color:gray;background-color:gray"><pre class="u-pre u-monospace MetadataMessage">cros: Make AcceleratorHistory higher priority

Background: AcceleratorFilter keeps track of pressed keys through
AcceleratorHistory. AcceleratorFilter is a PreTargetEventHandler on
Shell.

AcceleratorController uses AcceleratorHistory to ensure proper
accelerators are triggered. For example, a user could press:
1. Search key
2. Release Search
  - At this point, AcceleratorHistory is used to determine that no
    other keys are pressed as Search is released.

There are various issues where other PreTargetHandlers handle KeyEvents,
preventing AcceleratorHistory from seeing them. This means that in some
cases (crbug.com/1174603, crbug.com/1172970) AcceleratorHistory is
tricked into thinking keys are always pressed.

The control flow for AcceleratorController is:
 - AcceleratorHistory learns of a KeyEvent
 - AcceleratorController then uses AcceleratorHistory to validate
   certain accelerators.

The Solution:
 - Make AcceleratorHistory observe aura env independently of
   AcceleratorFilter.

AcceleratorHistory then gets a guarantee that no other
PreTargetEventHandlers will prevent it from seeing events.

This is safe because AcceleratorHistory does not ever SetHandled() or
StopPropagation() on events. It should have no effect on other areas of
the code.

In addition, AcceleratorHistory still learns of the event prior to
its utilization by AcceleratorController.

Bug: 1174603
Change-Id: <a href="https://chromium-review.googlesource.com/#/q/Ic3469f9bcf8f3dd14200bf09aa0bff444300f910">Ic3469f9bcf8f3dd14200bf09aa0bff444300f910</a>
Reviewed-on: <a href="https://chromium-review.googlesource.com/c/chromium/src/+/2724033">https://chromium-review.googlesource.com/c/chromium/src/+/2724033</a>
Reviewed-by: Ahmed Fakhry &lt;afakhry@chromium.org&gt;
Reviewed-by: Dominic Mazzoni &lt;dmazzoni@chromium.org&gt;
Reviewed-by: Scott Violet &lt;sky@chromium.org&gt;
Commit-Queue: Alex Newcomer &lt;newcomer@chromium.org&gt;
Cr-Commit-Position: refs/heads/master@{#858775}
</pre>

</body>
</html>
