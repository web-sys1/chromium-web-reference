<!DOCTYPE html>
<html>
<head>
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta content="utf-8" http-equiv="encoding">
<base href="https://chromium.googlesource.com/">
<style type="text/css">
table.blueTable {
  border: 1px solid #1C6EA4;
  background-color: #EEEEEE;
  width: 100%;
  text-align: center;
  border-collapse: collapse;
}
table.blueTable td, table.blueTable th {
  border: 1px solid #AAAAAA;
  padding: 3px 2px;
}
table.blueTable tbody td {
  font-size: 16px;
}
table.blueTable tr:nth-child(even) {
  background: #D0E4F5;
}
table.blueTable thead {
  background: #3077A4;
  background: -moz-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: -webkit-linear-gradient(top, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  background: linear-gradient(to bottom, #6499bb 0%, #4484ad 66%, #3077A4 100%);
  border-bottom: 2px solid #444444;
}
table.blueTable thead th {
  font-size: 15px;
  font-weight: bold;
  color: #FFFFFF;
  text-align: center;
  border-left: 2px solid #D0E4F5;
}
table.blueTable thead th:first-child {
  border-left: none;
}
table.blueTable tfoot {
  font-size: 8px;
  font-weight: bold;
  color: #FFFFFF;
  background: #D0E4F5;
  background: -moz-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: -webkit-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  background: linear-gradient(to bottom, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
  border-top: 2px solid #444444;
}
table.blueTable tfoot td {
  font-size: 8px;
}
table.blueTable tfoot .links {
  text-align: right;
}
table.blueTable tfoot .links a{
  display: inline-block;
  background: #1C6EA4;
  color: #FFFFFF;
  padding: 2px 8px;
  border-radius: 5px;
}
body{
    background: #fff2e0;
}
.Metadata {
    margin-bottom: 15px;
}
.u-monospace {
    font-family: 'Source Code Pro',monospace;
    max-width: 100%;
    overflow-x: scroll;
    border: groove #c33b3b 2px;
}
.MetadataMessage {
    background-color: #b9caff;
    border: 1px solid #de5353;
    color: #000;
    margin: 0;
    padding: 12px;
    white-space: pre-wrap;
}
</style>
</head>
<body>

    <table class="blueTable">
     <thead>
      <tr>
       <th><strong>REVISION ID</strong></th>
       <th>SHA-1 COMMIT</th>
      </tr>
    </thead>
    <tfoot></tfoot>
     <tbody>
      <tr>
       <td><a href ="https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Mac/1484164/"> 1484164</a> <sup><b>(MAC)</b></sup></td>
       <td><a href="https://chromium.googlesource.com/chromium/src/+/cb1aa794f2682f2881de9ef057348d2f4f83a488">cb1aa794f2682f2881de9ef057348d2f4f83a488</a></td>
      </tr>
      <tr>
       <td><a href ="https://commondatastorage.googleapis.com/chromium-browser-snapshots/index.html?prefix=Win/1484163/">1484163</a> <sup><b>(WIN)</b></sup></td>
       <td><a href="https://chromium.googlesource.com/chromium/src/+/71a82edac606bb80ee4c691ac071b3e444108e29">71a82edac606bb80ee4c691ac071b3e444108e29</a></td>
     </tbody>
    </table>
   <hr><table>
 <tr>
  <th class="Metadata-title">
   commit
  </th>
  <td>
   cb1aa794f2682f2881de9ef057348d2f4f83a488
  </td>
  <td>
   <span>
    [
    <a href="/chromium/src/+log/cb1aa794f2682f2881de9ef057348d2f4f83a488">
     log
    </a>
    ]
   </span>
   <span>
    [
    <a href="/chromium/src/+archive/cb1aa794f2682f2881de9ef057348d2f4f83a488.tar.gz">
     tgz
    </a>
    ]
   </span>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   author
  </th>
  <td>
   Zhengyi Xu &lt;zhengyixu@microsoft.com&gt;
  </td>
  <td>
   Wed Jul 09 06:00:36 2025
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   committer
  </th>
  <td>
   Chromium LUCI CQ &lt;chromium-scoped@luci-project-accounts.iam.gserviceaccount.com&gt;
  </td>
  <td>
   Wed Jul 09 06:00:36 2025
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   tree
  </th>
  <td>
   <a href="/chromium/src/+/cb1aa794f2682f2881de9ef057348d2f4f83a488/">
    181255fe6c37337f3f9a84cd0c639e66d35389bb
   </a>
  </td>
 </tr>
 <tr>
  <th class="Metadata-title">
   parent
  </th>
  <td>
   <a href="/chromium/src/+/cb1aa794f2682f2881de9ef057348d2f4f83a488%5E">
    71a82edac606bb80ee4c691ac071b3e444108e29
   </a>
   <span>
    [
    <a href="/chromium/src/+/cb1aa794f2682f2881de9ef057348d2f4f83a488%5E%21/">
     diff
    </a>
    ]
   </span>
  </td>
 </tr>
</table>
<hr style="height:1px;border-width:0;color:gray;background-color:gray"><pre class="u-pre u-monospace MetadataMessage">[SxS] Update split view visibility in UpdateUIForContents

Currently, the split view visibility is only updated when we set the
WebContents. However, we should note that the layout manager will only
update the layout if (see `LayoutManagerBase::ApplyLayout`):
- The parent available size changes
- The child view is visible
- The bounds of the child view are not empty.

For the split view, if we switch from a split tab (focused on the split
tab, with left and right sizes not equal) to a non-split tab, and then
switch back, the following steps will occur: 1. Because the active tab
is the split tab, we will swap it to the first view and hide the
inactive view. 2. When switching back, we will set the `WebContents` and
set the bounds of both views.

In step 2, during the `UpdateUIForContents` layout, the split view is
not visible and will have empty bounds. However, thanks to the top
container separator line (visibility changed and has 1 pixel height),
the available size changes, so we will still update the split view's
size to empty before we set the `WebContents` and prevent a re-layout of
the split view `WebContents`.

But if the available size does not change, the split view will keep the
old size (original main tab size) and then layout to the correct size
after we set the WebContents. This will cause the split view WebContents
to re-layout twice when switching from the non-split tab to the split
tab.

So this CL ensures the split view visibility is updated before the
browser view does the first layout, preventing the possible re-layout.
Also added a test to verify there is no re-layout during tab switching.

Co-authored-by: estalin@chromium.org

Bug: 427608924
Change-Id: <a href="https://chromium-review.googlesource.com/#/q/Id4fb2eb0aa6fe53aab9ef94821c47f4d67f68841">Id4fb2eb0aa6fe53aab9ef94821c47f4d67f68841</a>
Reviewed-on: <a href="https://chromium-review.googlesource.com/c/chromium/src/+/6669682">https://chromium-review.googlesource.com/c/chromium/src/+/6669682</a>
Reviewed-by: Eshwar Stalin &lt;estalin@chromium.org&gt;
Reviewed-by: Dana Fried &lt;dfried@chromium.org&gt;
Commit-Queue: Zhengyi Xu &lt;zhengyixu@microsoft.com&gt;
Cr-Commit-Position: refs/heads/main@{#1484164}
</pre>

</body>
</html>
